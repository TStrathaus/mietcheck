"use strict";(()=>{var t={};t.id=6499,t.ids=[6499],t.modules={72934:t=>{t.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:t=>{t.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:t=>{t.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:t=>{t.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:t=>{t.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},27790:t=>{t.exports=require("assert")},61212:t=>{t.exports=require("async_hooks")},78893:t=>{t.exports=require("buffer")},84770:t=>{t.exports=require("crypto")},17702:t=>{t.exports=require("events")},92048:t=>{t.exports=require("fs")},32615:t=>{t.exports=require("http")},35240:t=>{t.exports=require("https")},98216:t=>{t.exports=require("net")},19801:t=>{t.exports=require("os")},55315:t=>{t.exports=require("path")},86624:t=>{t.exports=require("querystring")},76162:t=>{t.exports=require("stream")},82452:t=>{t.exports=require("tls")},17360:t=>{t.exports=require("url")},21764:t=>{t.exports=require("util")},71568:t=>{t.exports=require("zlib")},63757:t=>{t.exports=import("prettier/plugins/html")},45747:t=>{t.exports=import("prettier/standalone")},84492:t=>{t.exports=require("node:stream")},63487:(t,e,i)=>{i.a(t,async(t,s)=>{try{i.r(e),i.d(e,{originalPathname:()=>f,patchFetch:()=>l,requestAsyncStorage:()=>d,routeModule:()=>c,serverHooks:()=>p,staticGenerationAsyncStorage:()=>u});var r=i(49303),o=i(88716),a=i(60670),h=i(9696),n=t([h]);h=(n.then?(await n)():n)[0];let c=new r.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/send-email/route",pathname:"/api/send-email",filename:"route",bundlePath:"app/api/send-email/route"},resolvedPagePath:"D:\\STTH\\2026 KI\\mietcheck\\src\\app\\api\\send-email\\route.ts",nextConfigOutput:"",userland:h}),{requestAsyncStorage:d,staticGenerationAsyncStorage:u,serverHooks:p}=c,f="/api/send-email/route";function l(){return(0,a.patchFetch)({serverHooks:p,staticGenerationAsyncStorage:u})}s()}catch(t){s(t)}})},53797:(t,e)=>{e.Z=function(t){return{id:"credentials",name:"Credentials",type:"credentials",credentials:{},authorize:()=>null,options:t}}},9696:(t,e,i)=>{i.a(t,async(t,s)=>{try{i.r(e),i.d(e,{POST:()=>c});var r=i(87070),o=i(75571),a=i(95456),h=i(92274),n=i(72465),l=t([h]);h=(l.then?(await l)():l)[0];let d=(0,n.h)({interval:36e5,uniqueTokenPerInterval:500});async function c(t){try{let e=await (0,o.getServerSession)(a.L);if(!e?.user?.email)return r.NextResponse.json({success:!1,error:"Unauthorized - Please log in"},{status:401});let i=e.user.email;try{await d.check(5,i)}catch{return r.NextResponse.json({success:!1,error:"Rate limit exceeded. Please try again later."},{status:429})}let{type:s,data:n}=await t.json();if(!s||!n)return r.NextResponse.json({success:!1,error:"Missing email type or data"},{status:400});if(n.to!==e.user.email)return r.NextResponse.json({success:!1,error:"Email recipient must match authenticated user"},{status:403});console.log("\uD83D\uDCE7 Sending email:",{type:s,to:n.to,userName:n.userName});let l=await (0,h.Cz)({type:s,data:n});if(!l.success)return r.NextResponse.json({success:!1,error:l.error||"Failed to send email"},{status:500});return r.NextResponse.json({success:!0,id:l.id})}catch(t){return console.error("❌ Send email API error:",t),r.NextResponse.json({success:!1,error:t.message||"Failed to send email"},{status:500})}}s()}catch(t){s(t)}})},95456:(t,e,i)=>{i.d(e,{L:()=>h});var s=i(53797),r=i(42023),o=i.n(r),a=i(86923);let h={providers:[(0,s.Z)({name:"Credentials",credentials:{email:{label:"Email",type:"email"},password:{label:"Password",type:"password"}},async authorize(t){if(!t?.email||!t?.password)return null;try{let e=(await (0,a.i6)`
            SELECT id, email, password_hash, name
            FROM users
            WHERE email = ${t.email.toLowerCase().trim()}
          `).rows[0];if(!e||!await o().compare(t.password,e.password_hash))return null;return console.log("✅ Login successful for:",e.email),{id:e.id.toString(),email:e.email,name:e.name}}catch(t){return console.error("❌ Auth error:",t),null}}})],pages:{signIn:"/login",signOut:"/login",error:"/login"},callbacks:{jwt:async({token:t,user:e})=>(e&&(t.id=e.id),t),session:async({session:t,token:e})=>(t.user&&(t.user.id=e.id),t)},session:{strategy:"jwt",maxAge:2592e3},secret:process.env.NEXTAUTH_SECRET}},72465:(t,e,i)=>{i.d(e,{h:()=>S});let s="object"==typeof performance&&performance&&"function"==typeof performance.now?performance:Date,r=new Set,o="object"==typeof process&&process?process:{},a=(t,e,i,s)=>{"function"==typeof o.emitWarning?o.emitWarning(t,e,i,s):console.error(`[${i}] ${e}: ${t}`)},h=globalThis.AbortController,n=globalThis.AbortSignal;if(void 0===h){n=class{onabort;_onabort=[];reason;aborted=!1;addEventListener(t,e){this._onabort.push(e)}},h=class{constructor(){e()}signal=new n;abort(t){if(!this.signal.aborted){for(let e of(this.signal.reason=t,this.signal.aborted=!0,this.signal._onabort))e(t);this.signal.onabort?.(t)}}};let t=o.env?.LRU_CACHE_IGNORE_AC_WARNING!=="1",e=()=>{t&&(t=!1,a("AbortController is not defined. If using lru-cache in node 14, load an AbortController polyfill from the `node-abort-controller` package. A minimal polyfill is provided for use by LRUCache.fetch(), but it should not be relied upon in other contexts (eg, passing it to other APIs that use AbortController/AbortSignal might have undesirable effects). You may disable this with LRU_CACHE_IGNORE_AC_WARNING=1 in the env.","NO_ABORT_CONTROLLER","ENOTSUP",e))}}let l=t=>!r.has(t);Symbol("type");let c=t=>t&&t===Math.floor(t)&&t>0&&isFinite(t),d=t=>c(t)?t<=256?Uint8Array:t<=65536?Uint16Array:t<=4294967296?Uint32Array:t<=Number.MAX_SAFE_INTEGER?u:null:null;class u extends Array{constructor(t){super(t),this.fill(0)}}class p{heap;length;static #t=!1;static create(t){let e=d(t);if(!e)return[];p.#t=!0;let i=new p(t,e);return p.#t=!1,i}constructor(t,e){if(!p.#t)throw TypeError("instantiate Stack using Stack.create(n)");this.heap=new e(t),this.length=0}push(t){this.heap[this.length++]=t}pop(){return this.heap[--this.length]}}class f{#e;#i;#s;#r;#o;#a;#h;#n;get perf(){return this.#n}ttl;ttlResolution;ttlAutopurge;updateAgeOnGet;updateAgeOnHas;allowStale;noDisposeOnSet;noUpdateTTL;maxEntrySize;sizeCalculation;noDeleteOnFetchRejection;noDeleteOnStaleGet;allowStaleOnFetchAbort;allowStaleOnFetchRejection;ignoreFetchAbort;#l;#c;#d;#u;#p;#f;#g;#m;#v;#y;#x;#S;#w;#L;#_;#T;#z;#k;#A;static unsafeExposeInternals(t){return{starts:t.#w,ttls:t.#L,autopurgeTimers:t.#_,sizes:t.#S,keyMap:t.#d,keyList:t.#u,valList:t.#p,next:t.#f,prev:t.#g,get head(){return t.#m},get tail(){return t.#v},free:t.#y,isBackgroundFetch:e=>t.#F(e),backgroundFetch:(e,i,s,r)=>t.#E(e,i,s,r),moveToTail:e=>t.#b(e),indexes:e=>t.#O(e),rindexes:e=>t.#D(e),isStale:e=>t.#R(e)}}get max(){return this.#e}get maxSize(){return this.#i}get calculatedSize(){return this.#c}get size(){return this.#l}get fetchMethod(){return this.#a}get memoMethod(){return this.#h}get dispose(){return this.#s}get onInsert(){return this.#r}get disposeAfter(){return this.#o}constructor(t){let{max:e=0,ttl:i,ttlResolution:o=1,ttlAutopurge:h,updateAgeOnGet:n,updateAgeOnHas:u,allowStale:g,dispose:m,onInsert:v,disposeAfter:y,noDisposeOnSet:x,noUpdateTTL:S,maxSize:w=0,maxEntrySize:L=0,sizeCalculation:_,fetchMethod:T,memoMethod:z,noDeleteOnFetchRejection:k,noDeleteOnStaleGet:A,allowStaleOnFetchRejection:F,allowStaleOnFetchAbort:E,ignoreFetchAbort:b,perf:O}=t;if(void 0!==O&&"function"!=typeof O?.now)throw TypeError("perf option must have a now() method if specified");if(this.#n=O??s,0!==e&&!c(e))throw TypeError("max option must be a nonnegative integer");let D=e?d(e):Array;if(!D)throw Error("invalid max value: "+e);if(this.#e=e,this.#i=w,this.maxEntrySize=L||this.#i,this.sizeCalculation=_,this.sizeCalculation){if(!this.#i&&!this.maxEntrySize)throw TypeError("cannot set sizeCalculation without setting maxSize or maxEntrySize");if("function"!=typeof this.sizeCalculation)throw TypeError("sizeCalculation set to non-function")}if(void 0!==z&&"function"!=typeof z)throw TypeError("memoMethod must be a function if defined");if(this.#h=z,void 0!==T&&"function"!=typeof T)throw TypeError("fetchMethod must be a function if specified");if(this.#a=T,this.#z=!!T,this.#d=new Map,this.#u=Array(e).fill(void 0),this.#p=Array(e).fill(void 0),this.#f=new D(e),this.#g=new D(e),this.#m=0,this.#v=0,this.#y=p.create(e),this.#l=0,this.#c=0,"function"==typeof m&&(this.#s=m),"function"==typeof v&&(this.#r=v),"function"==typeof y?(this.#o=y,this.#x=[]):(this.#o=void 0,this.#x=void 0),this.#T=!!this.#s,this.#A=!!this.#r,this.#k=!!this.#o,this.noDisposeOnSet=!!x,this.noUpdateTTL=!!S,this.noDeleteOnFetchRejection=!!k,this.allowStaleOnFetchRejection=!!F,this.allowStaleOnFetchAbort=!!E,this.ignoreFetchAbort=!!b,0!==this.maxEntrySize){if(0!==this.#i&&!c(this.#i))throw TypeError("maxSize must be a positive integer if specified");if(!c(this.maxEntrySize))throw TypeError("maxEntrySize must be a positive integer if specified");this.#C()}if(this.allowStale=!!g,this.noDeleteOnStaleGet=!!A,this.updateAgeOnGet=!!n,this.updateAgeOnHas=!!u,this.ttlResolution=c(o)||0===o?o:1,this.ttlAutopurge=!!h,this.ttl=i||0,this.ttl){if(!c(this.ttl))throw TypeError("ttl must be a positive integer if specified");this.#M()}if(0===this.#e&&0===this.ttl&&0===this.#i)throw TypeError("At least one of max, maxSize, or ttl is required");if(!this.ttlAutopurge&&!this.#e&&!this.#i){let t="LRU_CACHE_UNBOUNDED";l(t)&&(r.add(t),a("TTL caching without ttlAutopurge, max, or maxSize can result in unbounded memory consumption.","UnboundedCacheWarning",t,f))}}getRemainingTTL(t){return this.#d.has(t)?1/0:0}#M(){let t=new u(this.#e),e=new u(this.#e);this.#L=t,this.#w=e;let i=this.ttlAutopurge?Array(this.#e):void 0;this.#_=i,this.#I=(s,r,o=this.#n.now())=>{if(e[s]=0!==r?o:0,t[s]=r,i?.[s]&&(clearTimeout(i[s]),i[s]=void 0),0!==r&&i){let t=setTimeout(()=>{this.#R(s)&&this.#W(this.#u[s],"expire")},r+1);t.unref&&t.unref(),i[s]=t}},this.#q=i=>{e[i]=0!==t[i]?this.#n.now():0},this.#j=(i,o)=>{if(t[o]){let a=t[o],h=e[o];if(!a||!h)return;i.ttl=a,i.start=h,i.now=s||r();let n=i.now-h;i.remainingTTL=a-n}};let s=0,r=()=>{let t=this.#n.now();if(this.ttlResolution>0){s=t;let e=setTimeout(()=>s=0,this.ttlResolution);e.unref&&e.unref()}return t};this.getRemainingTTL=i=>{let o=this.#d.get(i);if(void 0===o)return 0;let a=t[o],h=e[o];return a&&h?a-((s||r())-h):1/0},this.#R=i=>{let o=e[i],a=t[i];return!!a&&!!o&&(s||r())-o>a}}#q=()=>{};#j=()=>{};#I=()=>{};#R=()=>!1;#C(){let t=new u(this.#e);this.#c=0,this.#S=t,this.#N=e=>{this.#c-=t[e],t[e]=0},this.#B=(t,e,i,s)=>{if(this.#F(e))return 0;if(!c(i)){if(s){if("function"!=typeof s)throw TypeError("sizeCalculation must be a function");if(!c(i=s(e,t)))throw TypeError("sizeCalculation return invalid (expect positive integer)")}else throw TypeError("invalid size value (must be positive integer). When maxSize or maxEntrySize is used, sizeCalculation or size must be set.")}return i},this.#P=(e,i,s)=>{if(t[e]=i,this.#i){let i=this.#i-t[e];for(;this.#c>i;)this.#U(!0)}this.#c+=t[e],s&&(s.entrySize=i,s.totalCalculatedSize=this.#c)}}#N=t=>{};#P=(t,e,i)=>{};#B=(t,e,i,s)=>{if(i||s)throw TypeError("cannot set size without setting maxSize or maxEntrySize on cache");return 0};*#O({allowStale:t=this.allowStale}={}){if(this.#l)for(let e=this.#v;this.#$(e)&&((t||!this.#R(e))&&(yield e),e!==this.#m);)e=this.#g[e]}*#D({allowStale:t=this.allowStale}={}){if(this.#l)for(let e=this.#m;this.#$(e)&&((t||!this.#R(e))&&(yield e),e!==this.#v);)e=this.#f[e]}#$(t){return void 0!==t&&this.#d.get(this.#u[t])===t}*entries(){for(let t of this.#O())void 0===this.#p[t]||void 0===this.#u[t]||this.#F(this.#p[t])||(yield[this.#u[t],this.#p[t]])}*rentries(){for(let t of this.#D())void 0===this.#p[t]||void 0===this.#u[t]||this.#F(this.#p[t])||(yield[this.#u[t],this.#p[t]])}*keys(){for(let t of this.#O()){let e=this.#u[t];void 0===e||this.#F(this.#p[t])||(yield e)}}*rkeys(){for(let t of this.#D()){let e=this.#u[t];void 0===e||this.#F(this.#p[t])||(yield e)}}*values(){for(let t of this.#O())void 0===this.#p[t]||this.#F(this.#p[t])||(yield this.#p[t])}*rvalues(){for(let t of this.#D())void 0===this.#p[t]||this.#F(this.#p[t])||(yield this.#p[t])}[Symbol.iterator](){return this.entries()}[Symbol.toStringTag]="LRUCache";find(t,e={}){for(let i of this.#O()){let s=this.#p[i],r=this.#F(s)?s.__staleWhileFetching:s;if(void 0!==r&&t(r,this.#u[i],this))return this.get(this.#u[i],e)}}forEach(t,e=this){for(let i of this.#O()){let s=this.#p[i],r=this.#F(s)?s.__staleWhileFetching:s;void 0!==r&&t.call(e,r,this.#u[i],this)}}rforEach(t,e=this){for(let i of this.#D()){let s=this.#p[i],r=this.#F(s)?s.__staleWhileFetching:s;void 0!==r&&t.call(e,r,this.#u[i],this)}}purgeStale(){let t=!1;for(let e of this.#D({allowStale:!0}))this.#R(e)&&(this.#W(this.#u[e],"expire"),t=!0);return t}info(t){let e=this.#d.get(t);if(void 0===e)return;let i=this.#p[e],s=this.#F(i)?i.__staleWhileFetching:i;if(void 0===s)return;let r={value:s};if(this.#L&&this.#w){let t=this.#L[e],i=this.#w[e];if(t&&i){let e=t-(this.#n.now()-i);r.ttl=e,r.start=Date.now()}}return this.#S&&(r.size=this.#S[e]),r}dump(){let t=[];for(let e of this.#O({allowStale:!0})){let i=this.#u[e],s=this.#p[e],r=this.#F(s)?s.__staleWhileFetching:s;if(void 0===r||void 0===i)continue;let o={value:r};if(this.#L&&this.#w){o.ttl=this.#L[e];let t=this.#n.now()-this.#w[e];o.start=Math.floor(Date.now()-t)}this.#S&&(o.size=this.#S[e]),t.unshift([i,o])}return t}load(t){for(let[e,i]of(this.clear(),t)){if(i.start){let t=Date.now()-i.start;i.start=this.#n.now()-t}this.set(e,i.value,i)}}set(t,e,i={}){if(void 0===e)return this.delete(t),this;let{ttl:s=this.ttl,start:r,noDisposeOnSet:o=this.noDisposeOnSet,sizeCalculation:a=this.sizeCalculation,status:h}=i,{noUpdateTTL:n=this.noUpdateTTL}=i,l=this.#B(t,e,i.size||0,a);if(this.maxEntrySize&&l>this.maxEntrySize)return h&&(h.set="miss",h.maxEntrySizeExceeded=!0),this.#W(t,"set"),this;let c=0===this.#l?void 0:this.#d.get(t);if(void 0===c)c=0===this.#l?this.#v:0!==this.#y.length?this.#y.pop():this.#l===this.#e?this.#U(!1):this.#l,this.#u[c]=t,this.#p[c]=e,this.#d.set(t,c),this.#f[this.#v]=c,this.#g[c]=this.#v,this.#v=c,this.#l++,this.#P(c,l,h),h&&(h.set="add"),n=!1,this.#A&&this.#r?.(e,t,"add");else{this.#b(c);let i=this.#p[c];if(e!==i){if(this.#z&&this.#F(i)){i.__abortController.abort(Error("replaced"));let{__staleWhileFetching:e}=i;void 0!==e&&!o&&(this.#T&&this.#s?.(e,t,"set"),this.#k&&this.#x?.push([e,t,"set"]))}else!o&&(this.#T&&this.#s?.(i,t,"set"),this.#k&&this.#x?.push([i,t,"set"]));if(this.#N(c),this.#P(c,l,h),this.#p[c]=e,h){h.set="replace";let t=i&&this.#F(i)?i.__staleWhileFetching:i;void 0!==t&&(h.oldValue=t)}}else h&&(h.set="update");this.#A&&this.onInsert?.(e,t,e===i?"update":"replace")}if(0===s||this.#L||this.#M(),this.#L&&(n||this.#I(c,s,r),h&&this.#j(h,c)),!o&&this.#k&&this.#x){let t;let e=this.#x;for(;t=e?.shift();)this.#o?.(...t)}return this}pop(){try{for(;this.#l;){let t=this.#p[this.#m];if(this.#U(!0),this.#F(t)){if(t.__staleWhileFetching)return t.__staleWhileFetching}else if(void 0!==t)return t}}finally{if(this.#k&&this.#x){let t;let e=this.#x;for(;t=e?.shift();)this.#o?.(...t)}}}#U(t){let e=this.#m,i=this.#u[e],s=this.#p[e];return this.#z&&this.#F(s)?s.__abortController.abort(Error("evicted")):(this.#T||this.#k)&&(this.#T&&this.#s?.(s,i,"evict"),this.#k&&this.#x?.push([s,i,"evict"])),this.#N(e),this.#_?.[e]&&(clearTimeout(this.#_[e]),this.#_[e]=void 0),t&&(this.#u[e]=void 0,this.#p[e]=void 0,this.#y.push(e)),1===this.#l?(this.#m=this.#v=0,this.#y.length=0):this.#m=this.#f[e],this.#d.delete(i),this.#l--,e}has(t,e={}){let{updateAgeOnHas:i=this.updateAgeOnHas,status:s}=e,r=this.#d.get(t);if(void 0!==r){let t=this.#p[r];if(this.#F(t)&&void 0===t.__staleWhileFetching)return!1;if(!this.#R(r))return i&&this.#q(r),s&&(s.has="hit",this.#j(s,r)),!0;s&&(s.has="stale",this.#j(s,r))}else s&&(s.has="miss");return!1}peek(t,e={}){let{allowStale:i=this.allowStale}=e,s=this.#d.get(t);if(void 0===s||!i&&this.#R(s))return;let r=this.#p[s];return this.#F(r)?r.__staleWhileFetching:r}#E(t,e,i,s){let r=void 0===e?void 0:this.#p[e];if(this.#F(r))return r;let o=new h,{signal:a}=i;a?.addEventListener("abort",()=>o.abort(a.reason),{signal:o.signal});let n={signal:o.signal,options:i,context:s},l=(s,r=!1)=>{let{aborted:a}=o.signal,h=i.ignoreFetchAbort&&void 0!==s,l=i.ignoreFetchAbort||!!(i.allowStaleOnFetchAbort&&void 0!==s);if(i.status&&(a&&!r?(i.status.fetchAborted=!0,i.status.fetchError=o.signal.reason,h&&(i.status.fetchAbortIgnored=!0)):i.status.fetchResolved=!0),a&&!h&&!r)return c(o.signal.reason,l);let u=this.#p[e];return(u===d||h&&r&&void 0===u)&&(void 0===s?void 0!==d.__staleWhileFetching?this.#p[e]=d.__staleWhileFetching:this.#W(t,"fetch"):(i.status&&(i.status.fetchUpdated=!0),this.set(t,s,n.options))),s},c=(s,r)=>{let{aborted:a}=o.signal,h=a&&i.allowStaleOnFetchAbort,n=h||i.allowStaleOnFetchRejection,l=n||i.noDeleteOnFetchRejection;if(this.#p[e]!==d||(l&&(r||void 0!==d.__staleWhileFetching)?h||(this.#p[e]=d.__staleWhileFetching):this.#W(t,"fetch")),n)return i.status&&void 0!==d.__staleWhileFetching&&(i.status.returnedStale=!0),d.__staleWhileFetching;if(d.__returned===d)throw s};i.status&&(i.status.fetchDispatched=!0);let d=new Promise((e,s)=>{let a=this.#a?.(t,r,n);a&&a instanceof Promise&&a.then(t=>e(void 0===t?void 0:t),s),o.signal.addEventListener("abort",()=>{(!i.ignoreFetchAbort||i.allowStaleOnFetchAbort)&&(e(void 0),i.allowStaleOnFetchAbort&&(e=t=>l(t,!0)))})}).then(l,t=>(i.status&&(i.status.fetchRejected=!0,i.status.fetchError=t),c(t,!1))),u=Object.assign(d,{__abortController:o,__staleWhileFetching:r,__returned:void 0});return void 0===e?(this.set(t,u,{...n.options,status:void 0}),e=this.#d.get(t)):this.#p[e]=u,u}#F(t){return!!this.#z&&!!t&&t instanceof Promise&&t.hasOwnProperty("__staleWhileFetching")&&t.__abortController instanceof h}async fetch(t,e={}){let{allowStale:i=this.allowStale,updateAgeOnGet:s=this.updateAgeOnGet,noDeleteOnStaleGet:r=this.noDeleteOnStaleGet,ttl:o=this.ttl,noDisposeOnSet:a=this.noDisposeOnSet,size:h=0,sizeCalculation:n=this.sizeCalculation,noUpdateTTL:l=this.noUpdateTTL,noDeleteOnFetchRejection:c=this.noDeleteOnFetchRejection,allowStaleOnFetchRejection:d=this.allowStaleOnFetchRejection,ignoreFetchAbort:u=this.ignoreFetchAbort,allowStaleOnFetchAbort:p=this.allowStaleOnFetchAbort,context:f,forceRefresh:g=!1,status:m,signal:v}=e;if(!this.#z)return m&&(m.fetch="get"),this.get(t,{allowStale:i,updateAgeOnGet:s,noDeleteOnStaleGet:r,status:m});let y={allowStale:i,updateAgeOnGet:s,noDeleteOnStaleGet:r,ttl:o,noDisposeOnSet:a,size:h,sizeCalculation:n,noUpdateTTL:l,noDeleteOnFetchRejection:c,allowStaleOnFetchRejection:d,allowStaleOnFetchAbort:p,ignoreFetchAbort:u,status:m,signal:v},x=this.#d.get(t);if(void 0===x){m&&(m.fetch="miss");let e=this.#E(t,x,y,f);return e.__returned=e}{let e=this.#p[x];if(this.#F(e)){let t=i&&void 0!==e.__staleWhileFetching;return m&&(m.fetch="inflight",t&&(m.returnedStale=!0)),t?e.__staleWhileFetching:e.__returned=e}let r=this.#R(x);if(!g&&!r)return m&&(m.fetch="hit"),this.#b(x),s&&this.#q(x),m&&this.#j(m,x),e;let o=this.#E(t,x,y,f),a=void 0!==o.__staleWhileFetching&&i;return m&&(m.fetch=r?"stale":"refresh",a&&r&&(m.returnedStale=!0)),a?o.__staleWhileFetching:o.__returned=o}}async forceFetch(t,e={}){let i=await this.fetch(t,e);if(void 0===i)throw Error("fetch() returned undefined");return i}memo(t,e={}){let i=this.#h;if(!i)throw Error("no memoMethod provided to constructor");let{context:s,forceRefresh:r,...o}=e,a=this.get(t,o);if(!r&&void 0!==a)return a;let h=i(t,a,{options:o,context:s});return this.set(t,h,o),h}get(t,e={}){let{allowStale:i=this.allowStale,updateAgeOnGet:s=this.updateAgeOnGet,noDeleteOnStaleGet:r=this.noDeleteOnStaleGet,status:o}=e,a=this.#d.get(t);if(void 0!==a){let e=this.#p[a],h=this.#F(e);return(o&&this.#j(o,a),this.#R(a))?(o&&(o.get="stale"),h)?(o&&i&&void 0!==e.__staleWhileFetching&&(o.returnedStale=!0),i?e.__staleWhileFetching:void 0):(r||this.#W(t,"expire"),o&&i&&(o.returnedStale=!0),i?e:void 0):(o&&(o.get="hit"),h)?e.__staleWhileFetching:(this.#b(a),s&&this.#q(a),e)}o&&(o.get="miss")}#G(t,e){this.#g[e]=t,this.#f[t]=e}#b(t){t!==this.#v&&(t===this.#m?this.#m=this.#f[t]:this.#G(this.#g[t],this.#f[t]),this.#G(this.#v,t),this.#v=t)}delete(t){return this.#W(t,"delete")}#W(t,e){let i=!1;if(0!==this.#l){let s=this.#d.get(t);if(void 0!==s){if(this.#_?.[s]&&(clearTimeout(this.#_?.[s]),this.#_[s]=void 0),i=!0,1===this.#l)this.#H(e);else{this.#N(s);let i=this.#p[s];if(this.#F(i)?i.__abortController.abort(Error("deleted")):(this.#T||this.#k)&&(this.#T&&this.#s?.(i,t,e),this.#k&&this.#x?.push([i,t,e])),this.#d.delete(t),this.#u[s]=void 0,this.#p[s]=void 0,s===this.#v)this.#v=this.#g[s];else if(s===this.#m)this.#m=this.#f[s];else{let t=this.#g[s];this.#f[t]=this.#f[s];let e=this.#f[s];this.#g[e]=this.#g[s]}this.#l--,this.#y.push(s)}}}if(this.#k&&this.#x?.length){let t;let e=this.#x;for(;t=e?.shift();)this.#o?.(...t)}return i}clear(){return this.#H("delete")}#H(t){for(let e of this.#D({allowStale:!0})){let i=this.#p[e];if(this.#F(i))i.__abortController.abort(Error("deleted"));else{let s=this.#u[e];this.#T&&this.#s?.(i,s,t),this.#k&&this.#x?.push([i,s,t])}}if(this.#d.clear(),this.#p.fill(void 0),this.#u.fill(void 0),this.#L&&this.#w){for(let t of(this.#L.fill(0),this.#w.fill(0),this.#_??[]))void 0!==t&&clearTimeout(t);this.#_?.fill(void 0)}if(this.#S&&this.#S.fill(0),this.#m=0,this.#v=0,this.#y.length=0,this.#c=0,this.#l=0,this.#k&&this.#x){let t;let e=this.#x;for(;t=e?.shift();)this.#o?.(...t)}}}let g=new(i(2723)).R(process.env.RESEND_API_KEY);async function m(t,e="info"){let i=process.env.SLACK_WEBHOOK_URL;if(!i){console.warn("Slack webhook not configured, skipping alert");return}let s={info:"ℹ️",warning:"⚠️",error:"\uD83D\uDEA8"};try{await fetch(i,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:`${s[e]} ${t}`,blocks:[{type:"section",text:{type:"mrkdwn",text:`${s[e]} *${e.toUpperCase()}*
${t}`}},{type:"context",elements:[{type:"mrkdwn",text:`Time: ${new Date().toISOString()} | Environment: ${process.env.VERCEL_ENV||"local"}`}]}]})}),console.log("✅ Slack alert sent:",e,t)}catch(t){console.error("❌ Failed to send Slack alert:",t)}}async function v(t,e,i="info"){let s=process.env.ADMIN_EMAIL||"thorsten.strathaus@gmail.com",r=process.env.EMAIL_FROM||"noreply@mietcheck-app.ch";if(!process.env.RESEND_API_KEY){console.warn("Resend not configured, skipping email alert");return}try{await g.emails.send({from:`MietCheck Alerts <${r}>`,to:s,subject:`${{info:"ℹ️",warning:"⚠️",error:"\uD83D\uDEA8"}[i]} [ALERT] ${t}`,text:`${e}

Time: ${new Date().toISOString()}
Environment: ${process.env.VERCEL_ENV||"local"}`}),console.log("✅ Email alert sent:",i,t)}catch(t){console.error("❌ Failed to send email alert:",t)}}async function y(t,e="info"){await Promise.allSettled([m(t,e),v(t,t,e)])}let x={rateLimitExceeded:t=>y(`Rate limit exceeded for IP: ${t}`,"warning")};function S(t){let e=new f({max:t?.uniqueTokenPerInterval||500,ttl:t?.interval||6e4});return{check:(t,i)=>new Promise((s,r)=>{let o=e.get(i)||[0];0===o[0]&&e.set(i,o),o[0]+=1;let a=o[0]>=t;return a&&o[0]===t&&x.rateLimitExceeded(i).catch(console.error),a?r():s()})}}}};var e=require("../../../webpack-runtime.js");e.C(t);var i=t=>e(e.s=t),s=e.X(0,[8948,1615,5972,6923,5571,2023,3752,2752],()=>i(63487));module.exports=s})();