{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 5, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/src/lib/db.ts"],"sourcesContent":["import { sql } from '@vercel/postgres';\n\nexport async function setupDatabase() {\n  try {\n    // Create users table\n    await sql`\n      CREATE TABLE IF NOT EXISTS users (\n        id SERIAL PRIMARY KEY,\n        email VARCHAR(255) UNIQUE NOT NULL,\n        password_hash VARCHAR(255) NOT NULL,\n        name VARCHAR(255),\n        created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n      );\n    `;\n\n    // Create contracts table with extended fields\n    await sql`\n      CREATE TABLE IF NOT EXISTS contracts (\n        id SERIAL PRIMARY KEY,\n        user_id INTEGER REFERENCES users(id) ON DELETE CASCADE,\n        address VARCHAR(500),\n        net_rent DECIMAL(10,2),\n        reference_rate DECIMAL(4,2),\n        contract_date DATE,\n        landlord_name VARCHAR(255),\n        landlord_address VARCHAR(500),\n        tenant_name VARCHAR(255),\n        tenant_address VARCHAR(500),\n        new_rent DECIMAL(10,2),\n        monthly_reduction DECIMAL(10,2),\n        yearly_savings DECIMAL(10,2),\n        created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n      );\n    `;\n\n    // Migration: Add new columns if they don't exist\n    await sql`\n      ALTER TABLE contracts\n      ADD COLUMN IF NOT EXISTS tenant_name VARCHAR(255),\n      ADD COLUMN IF NOT EXISTS tenant_address VARCHAR(500),\n      ADD COLUMN IF NOT EXISTS new_rent DECIMAL(10,2),\n      ADD COLUMN IF NOT EXISTS monthly_reduction DECIMAL(10,2),\n      ADD COLUMN IF NOT EXISTS yearly_savings DECIMAL(10,2);\n    `;\n\n    // Create transactions table\n    await sql`\n      CREATE TABLE IF NOT EXISTS transactions (\n        id SERIAL PRIMARY KEY,\n        user_id INTEGER REFERENCES users(id) ON DELETE CASCADE,\n        contract_id INTEGER REFERENCES contracts(id) ON DELETE CASCADE,\n        service_type VARCHAR(50),\n        amount DECIMAL(10,2),\n        stripe_session_id VARCHAR(255),\n        status VARCHAR(50) DEFAULT 'pending',\n        created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n      );\n    `;\n\n    console.log('‚úÖ Database tables created successfully');\n  } catch (error) {\n    console.error('‚ùå Error creating tables:', error);\n    throw error;\n  }\n}\n\nexport async function getUser(email: string) {\n  const result = await sql`\n    SELECT * FROM users WHERE email = ${email} LIMIT 1;\n  `;\n  return result.rows[0] || null;\n}\n\nexport async function createUser(email: string, passwordHash: string, name?: string) {\n  const result = await sql`\n    INSERT INTO users (email, password_hash, name)\n    VALUES (${email}, ${passwordHash}, ${name || ''})\n    RETURNING id, email, name, created_at;\n  `;\n  return result.rows[0];\n}\n\nexport async function createContract(userId: number, data: any) {\n  const result = await sql`\n    INSERT INTO contracts (\n      user_id, address, net_rent, reference_rate, contract_date,\n      landlord_name, landlord_address, tenant_name, tenant_address,\n      new_rent, monthly_reduction, yearly_savings\n    )\n    VALUES (\n      ${userId}, ${data.address}, ${data.netRent}, ${data.referenceRate},\n      ${data.contractDate}, ${data.landlordName || ''}, ${data.landlordAddress || ''},\n      ${data.tenantName || ''}, ${data.tenantAddress || ''},\n      ${data.newRent || null}, ${data.monthlyReduction || null}, ${data.yearlySavings || null}\n    )\n    RETURNING *;\n  `;\n  return result.rows[0];\n}\n\nexport async function createTransaction(userId: number, contractId: number, serviceType: string, amount: number) {\n  const result = await sql`\n    INSERT INTO transactions (user_id, contract_id, service_type, amount, status)\n    VALUES (${userId}, ${contractId}, ${serviceType}, ${amount}, 'completed')\n    RETURNING *;\n  `;\n  return result.rows[0];\n}\n\nexport async function getUserContracts(userId: number) {\n  const result = await sql`\n    SELECT * FROM contracts WHERE user_id = ${userId} ORDER BY created_at DESC;\n  `;\n  return result.rows;\n}\n\nexport async function getContractById(contractId: number, userId: number) {\n  const result = await sql`\n    SELECT * FROM contracts\n    WHERE id = ${contractId} AND user_id = ${userId}\n    LIMIT 1;\n  `;\n  return result.rows[0] || null;\n}\n\nexport async function updateContract(contractId: number, userId: number, data: any) {\n  const result = await sql`\n    UPDATE contracts\n    SET\n      address = ${data.address},\n      net_rent = ${data.netRent},\n      reference_rate = ${data.referenceRate},\n      contract_date = ${data.contractDate},\n      landlord_name = ${data.landlordName || ''},\n      landlord_address = ${data.landlordAddress || ''},\n      tenant_name = ${data.tenantName || ''},\n      tenant_address = ${data.tenantAddress || ''},\n      new_rent = ${data.newRent || null},\n      monthly_reduction = ${data.monthlyReduction || null},\n      yearly_savings = ${data.yearlySavings || null}\n    WHERE id = ${contractId} AND user_id = ${userId}\n    RETURNING *;\n  `;\n  return result.rows[0] || null;\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 151, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 156, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/src/emails/analysis-complete.tsx"],"sourcesContent":["// src/emails/analysis-complete.tsx\r\nimport {\r\n  Body,\r\n  Button,\r\n  Container,\r\n  Head,\r\n  Heading,\r\n  Html,\r\n  Preview,\r\n  Section,\r\n  Text,\r\n  Hr,\r\n} from '@react-email/components';\r\nimport * as React from 'react';\r\n\r\ninterface AnalysisCompleteEmailProps {\r\n  userName?: string;\r\n  address: string;\r\n  currentRent: number;\r\n  newRent: number;\r\n  monthlyReduction: number;\r\n  yearlyReduction: number;\r\n  dashboardUrl: string;\r\n}\r\n\r\nexport const AnalysisCompleteEmail = ({\r\n  userName = 'Mieter',\r\n  address,\r\n  currentRent,\r\n  newRent,\r\n  monthlyReduction,\r\n  yearlyReduction,\r\n  dashboardUrl,\r\n}: AnalysisCompleteEmailProps) => {\r\n  const previewText = `Ihre Mietanalyse f√ºr ${address} ist abgeschlossen`;\r\n\r\n  return (\r\n    <Html>\r\n      <Head />\r\n      <Preview>{previewText}</Preview>\r\n      <Body style={main}>\r\n        <Container style={container}>\r\n          <Heading style={h1}>‚úÖ Analyse abgeschlossen</Heading>\r\n\r\n          <Text style={text}>\r\n            Hallo {userName},\r\n          </Text>\r\n\r\n          <Text style={text}>\r\n            Gute Neuigkeiten! Die Analyse Ihres Mietvertrags ist abgeschlossen.\r\n          </Text>\r\n\r\n          <Section style={resultBox}>\r\n            <Heading style={h2}>üìç {address}</Heading>\r\n            <Hr style={hr} />\r\n\r\n            <Text style={resultText}>\r\n              <strong>Aktuelle Miete:</strong> CHF {currentRent.toFixed(2)}\r\n            </Text>\r\n            <Text style={resultText}>\r\n              <strong>Neue Miete:</strong> CHF {newRent.toFixed(2)}\r\n            </Text>\r\n            <Text style={highlightText}>\r\n              <strong>üí∞ M√∂gliche Ersparnis:</strong>\r\n            </Text>\r\n            <Text style={savingsText}>\r\n              CHF {monthlyReduction.toFixed(2)} / Monat\r\n            </Text>\r\n            <Text style={savingsText}>\r\n              CHF {yearlyReduction.toFixed(2)} / Jahr\r\n            </Text>\r\n          </Section>\r\n\r\n          <Section style={buttonContainer}>\r\n            <Button style={button} href={dashboardUrl}>\r\n              Ergebnis ansehen\r\n            </Button>\r\n          </Section>\r\n\r\n          <Text style={footerText}>\r\n            Sie k√∂nnen jetzt einen offiziellen Herabsetzungsbrief generieren und herunterladen.\r\n          </Text>\r\n\r\n          <Hr style={hr} />\r\n\r\n          <Text style={footer}>\r\n            MietCheck.ch - Ihr Mietrechts-Assistent\r\n            <br />\r\n            Diese Email wurde automatisch generiert.\r\n          </Text>\r\n        </Container>\r\n      </Body>\r\n    </Html>\r\n  );\r\n};\r\n\r\nexport default AnalysisCompleteEmail;\r\n\r\n// Styles\r\nconst main = {\r\n  backgroundColor: '#f6f9fc',\r\n  fontFamily:\r\n    '-apple-system,BlinkMacSystemFont,\"Segoe UI\",Roboto,\"Helvetica Neue\",Ubuntu,sans-serif',\r\n};\r\n\r\nconst container = {\r\n  backgroundColor: '#ffffff',\r\n  margin: '0 auto',\r\n  padding: '20px 0 48px',\r\n  marginBottom: '64px',\r\n  maxWidth: '600px',\r\n};\r\n\r\nconst h1 = {\r\n  color: '#1a1a1a',\r\n  fontSize: '28px',\r\n  fontWeight: 'bold',\r\n  margin: '40px 0',\r\n  padding: '0 40px',\r\n  lineHeight: '1.4',\r\n};\r\n\r\nconst h2 = {\r\n  color: '#1a1a1a',\r\n  fontSize: '20px',\r\n  fontWeight: '600',\r\n  margin: '0 0 15px',\r\n};\r\n\r\nconst text = {\r\n  color: '#444',\r\n  fontSize: '16px',\r\n  lineHeight: '26px',\r\n  padding: '0 40px',\r\n};\r\n\r\nconst resultBox = {\r\n  backgroundColor: '#f0f9ff',\r\n  border: '2px solid #3b82f6',\r\n  borderRadius: '8px',\r\n  margin: '24px 40px',\r\n  padding: '24px',\r\n};\r\n\r\nconst resultText = {\r\n  color: '#444',\r\n  fontSize: '16px',\r\n  lineHeight: '24px',\r\n  margin: '8px 0',\r\n};\r\n\r\nconst highlightText = {\r\n  color: '#1a1a1a',\r\n  fontSize: '18px',\r\n  fontWeight: 'bold',\r\n  margin: '16px 0 8px',\r\n};\r\n\r\nconst savingsText = {\r\n  color: '#16a34a',\r\n  fontSize: '20px',\r\n  fontWeight: 'bold',\r\n  margin: '4px 0',\r\n};\r\n\r\nconst buttonContainer = {\r\n  padding: '27px 40px',\r\n  textAlign: 'center' as const,\r\n};\r\n\r\nconst button = {\r\n  backgroundColor: '#3b82f6',\r\n  borderRadius: '6px',\r\n  color: '#fff',\r\n  fontSize: '16px',\r\n  fontWeight: 'bold',\r\n  textDecoration: 'none',\r\n  textAlign: 'center' as const,\r\n  display: 'inline-block',\r\n  padding: '12px 32px',\r\n};\r\n\r\nconst footerText = {\r\n  color: '#666',\r\n  fontSize: '14px',\r\n  lineHeight: '24px',\r\n  padding: '0 40px',\r\n  marginTop: '24px',\r\n};\r\n\r\nconst hr = {\r\n  borderColor: '#e6e6e6',\r\n  margin: '20px 0',\r\n};\r\n\r\nconst footer = {\r\n  color: '#8898aa',\r\n  fontSize: '12px',\r\n  lineHeight: '16px',\r\n  padding: '0 40px',\r\n  marginTop: '32px',\r\n};\r\n"],"names":[],"mappings":"AAAA,mCAAmC;;;;;;;;;;;;;;;;;;;AAyB5B,MAAM,wBAAwB,CAAC,EACpC,WAAW,QAAQ,EACnB,OAAO,EACP,WAAW,EACX,OAAO,EACP,gBAAgB,EAChB,eAAe,EACf,YAAY,EACe;IAC3B,MAAM,cAAc,CAAC,qBAAqB,EAAE,QAAQ,kBAAkB,CAAC;IAEvE,qBACE,0PAAC,4JAAA,CAAA,OAAI;;0BACH,0PAAC,4JAAA,CAAA,OAAI;;;;;0BACL,0PAAC,+JAAA,CAAA,UAAO;0BAAE;;;;;;0BACV,0PAAC,4JAAA,CAAA,OAAI;gBAAC,OAAO;0BACX,cAAA,0PAAC,iKAAA,CAAA,YAAS;oBAAC,OAAO;;sCAChB,0PAAC,+JAAA,CAAA,UAAO;4BAAC,OAAO;sCAAI;;;;;;sCAEpB,0PAAC,4JAAA,CAAA,OAAI;4BAAC,OAAO;;gCAAM;gCACV;gCAAS;;;;;;;sCAGlB,0PAAC,4JAAA,CAAA,OAAI;4BAAC,OAAO;sCAAM;;;;;;sCAInB,0PAAC,+JAAA,CAAA,UAAO;4BAAC,OAAO;;8CACd,0PAAC,+JAAA,CAAA,UAAO;oCAAC,OAAO;;wCAAI;wCAAI;;;;;;;8CACxB,0PAAC,0JAAA,CAAA,KAAE;oCAAC,OAAO;;;;;;8CAEX,0PAAC,4JAAA,CAAA,OAAI;oCAAC,OAAO;;sDACX,0PAAC;sDAAO;;;;;;wCAAwB;wCAAM,YAAY,OAAO,CAAC;;;;;;;8CAE5D,0PAAC,4JAAA,CAAA,OAAI;oCAAC,OAAO;;sDACX,0PAAC;sDAAO;;;;;;wCAAoB;wCAAM,QAAQ,OAAO,CAAC;;;;;;;8CAEpD,0PAAC,4JAAA,CAAA,OAAI;oCAAC,OAAO;8CACX,cAAA,0PAAC;kDAAO;;;;;;;;;;;8CAEV,0PAAC,4JAAA,CAAA,OAAI;oCAAC,OAAO;;wCAAa;wCACnB,iBAAiB,OAAO,CAAC;wCAAG;;;;;;;8CAEnC,0PAAC,4JAAA,CAAA,OAAI;oCAAC,OAAO;;wCAAa;wCACnB,gBAAgB,OAAO,CAAC;wCAAG;;;;;;;;;;;;;sCAIpC,0PAAC,+JAAA,CAAA,UAAO;4BAAC,OAAO;sCACd,cAAA,0PAAC,8JAAA,CAAA,SAAM;gCAAC,OAAO;gCAAQ,MAAM;0CAAc;;;;;;;;;;;sCAK7C,0PAAC,4JAAA,CAAA,OAAI;4BAAC,OAAO;sCAAY;;;;;;sCAIzB,0PAAC,0JAAA,CAAA,KAAE;4BAAC,OAAO;;;;;;sCAEX,0PAAC,4JAAA,CAAA,OAAI;4BAAC,OAAO;;gCAAQ;8CAEnB,0PAAC;;;;;gCAAK;;;;;;;;;;;;;;;;;;;;;;;;AAOlB;uCAEe;AAEf,SAAS;AACT,MAAM,OAAO;IACX,iBAAiB;IACjB,YACE;AACJ;AAEA,MAAM,YAAY;IAChB,iBAAiB;IACjB,QAAQ;IACR,SAAS;IACT,cAAc;IACd,UAAU;AACZ;AAEA,MAAM,KAAK;IACT,OAAO;IACP,UAAU;IACV,YAAY;IACZ,QAAQ;IACR,SAAS;IACT,YAAY;AACd;AAEA,MAAM,KAAK;IACT,OAAO;IACP,UAAU;IACV,YAAY;IACZ,QAAQ;AACV;AAEA,MAAM,OAAO;IACX,OAAO;IACP,UAAU;IACV,YAAY;IACZ,SAAS;AACX;AAEA,MAAM,YAAY;IAChB,iBAAiB;IACjB,QAAQ;IACR,cAAc;IACd,QAAQ;IACR,SAAS;AACX;AAEA,MAAM,aAAa;IACjB,OAAO;IACP,UAAU;IACV,YAAY;IACZ,QAAQ;AACV;AAEA,MAAM,gBAAgB;IACpB,OAAO;IACP,UAAU;IACV,YAAY;IACZ,QAAQ;AACV;AAEA,MAAM,cAAc;IAClB,OAAO;IACP,UAAU;IACV,YAAY;IACZ,QAAQ;AACV;AAEA,MAAM,kBAAkB;IACtB,SAAS;IACT,WAAW;AACb;AAEA,MAAM,SAAS;IACb,iBAAiB;IACjB,cAAc;IACd,OAAO;IACP,UAAU;IACV,YAAY;IACZ,gBAAgB;IAChB,WAAW;IACX,SAAS;IACT,SAAS;AACX;AAEA,MAAM,aAAa;IACjB,OAAO;IACP,UAAU;IACV,YAAY;IACZ,SAAS;IACT,WAAW;AACb;AAEA,MAAM,KAAK;IACT,aAAa;IACb,QAAQ;AACV;AAEA,MAAM,SAAS;IACb,OAAO;IACP,UAAU;IACV,YAAY;IACZ,SAAS;IACT,WAAW;AACb"}},
    {"offset": {"line": 481, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 486, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/src/emails/letter-generated.tsx"],"sourcesContent":["// src/emails/letter-generated.tsx\r\nimport {\r\n  Body,\r\n  Button,\r\n  Container,\r\n  Head,\r\n  Heading,\r\n  Html,\r\n  Preview,\r\n  Section,\r\n  Text,\r\n  Hr,\r\n} from '@react-email/components';\r\nimport * as React from 'react';\r\n\r\ninterface LetterGeneratedEmailProps {\r\n  userName?: string;\r\n  address: string;\r\n  monthlyReduction: number;\r\n  downloadUrl: string;\r\n  dashboardUrl: string;\r\n}\r\n\r\nexport const LetterGeneratedEmail = ({\r\n  userName = 'Mieter',\r\n  address,\r\n  monthlyReduction,\r\n  downloadUrl,\r\n  dashboardUrl,\r\n}: LetterGeneratedEmailProps) => {\r\n  const previewText = `Ihr Herabsetzungsbrief f√ºr ${address} ist bereit`;\r\n\r\n  return (\r\n    <Html>\r\n      <Head />\r\n      <Preview>{previewText}</Preview>\r\n      <Body style={main}>\r\n        <Container style={container}>\r\n          <Heading style={h1}>üìÑ Brief generiert</Heading>\r\n\r\n          <Text style={text}>\r\n            Hallo {userName},\r\n          </Text>\r\n\r\n          <Text style={text}>\r\n            Ihr offizieller Herabsetzungsbrief wurde erfolgreich generiert und steht zum Download bereit.\r\n          </Text>\r\n\r\n          <Section style={infoBox}>\r\n            <Heading style={h2}>üìç {address}</Heading>\r\n            <Text style={infoText}>\r\n              <strong>Beantragte Herabsetzung:</strong> CHF {monthlyReduction.toFixed(2)} / Monat\r\n            </Text>\r\n          </Section>\r\n\r\n          <Section style={buttonContainer}>\r\n            <Button style={button} href={downloadUrl}>\r\n              Brief herunterladen\r\n            </Button>\r\n          </Section>\r\n\r\n          <Section style={instructionBox}>\r\n            <Heading style={h3}>üìÆ N√§chste Schritte:</Heading>\r\n            <Text style={instructionText}>\r\n              1. Brief ausdrucken und unterschreiben\r\n            </Text>\r\n            <Text style={instructionText}>\r\n              2. Per <strong>A-Post Plus (Einschreiben)</strong> an Vermieter senden\r\n            </Text>\r\n            <Text style={instructionText}>\r\n              3. Kopie und Einschreibe-Beleg aufbewahren\r\n            </Text>\r\n            <Text style={instructionText}>\r\n              4. Auf Antwort des Vermieters warten (30 Tage Frist)\r\n            </Text>\r\n          </Section>\r\n\r\n          <Section style={buttonContainer}>\r\n            <Button style={secondaryButton} href={dashboardUrl}>\r\n              Zum Dashboard\r\n            </Button>\r\n          </Section>\r\n\r\n          <Hr style={hr} />\r\n\r\n          <Text style={footer}>\r\n            MietCheck.ch - Ihr Mietrechts-Assistent\r\n            <br />\r\n            Diese Email wurde automatisch generiert.\r\n          </Text>\r\n        </Container>\r\n      </Body>\r\n    </Html>\r\n  );\r\n};\r\n\r\nexport default LetterGeneratedEmail;\r\n\r\n// Styles\r\nconst main = {\r\n  backgroundColor: '#f6f9fc',\r\n  fontFamily:\r\n    '-apple-system,BlinkMacSystemFont,\"Segoe UI\",Roboto,\"Helvetica Neue\",Ubuntu,sans-serif',\r\n};\r\n\r\nconst container = {\r\n  backgroundColor: '#ffffff',\r\n  margin: '0 auto',\r\n  padding: '20px 0 48px',\r\n  marginBottom: '64px',\r\n  maxWidth: '600px',\r\n};\r\n\r\nconst h1 = {\r\n  color: '#1a1a1a',\r\n  fontSize: '28px',\r\n  fontWeight: 'bold',\r\n  margin: '40px 0',\r\n  padding: '0 40px',\r\n  lineHeight: '1.4',\r\n};\r\n\r\nconst h2 = {\r\n  color: '#1a1a1a',\r\n  fontSize: '20px',\r\n  fontWeight: '600',\r\n  margin: '0 0 15px',\r\n};\r\n\r\nconst h3 = {\r\n  color: '#1a1a1a',\r\n  fontSize: '18px',\r\n  fontWeight: '600',\r\n  margin: '0 0 16px',\r\n};\r\n\r\nconst text = {\r\n  color: '#444',\r\n  fontSize: '16px',\r\n  lineHeight: '26px',\r\n  padding: '0 40px',\r\n};\r\n\r\nconst infoBox = {\r\n  backgroundColor: '#f0fdf4',\r\n  border: '2px solid #16a34a',\r\n  borderRadius: '8px',\r\n  margin: '24px 40px',\r\n  padding: '24px',\r\n};\r\n\r\nconst infoText = {\r\n  color: '#444',\r\n  fontSize: '16px',\r\n  lineHeight: '24px',\r\n  margin: '8px 0',\r\n};\r\n\r\nconst instructionBox = {\r\n  backgroundColor: '#fef3c7',\r\n  border: '1px solid #f59e0b',\r\n  borderRadius: '8px',\r\n  margin: '24px 40px',\r\n  padding: '24px',\r\n};\r\n\r\nconst instructionText = {\r\n  color: '#444',\r\n  fontSize: '15px',\r\n  lineHeight: '24px',\r\n  margin: '8px 0',\r\n};\r\n\r\nconst buttonContainer = {\r\n  padding: '27px 40px',\r\n  textAlign: 'center' as const,\r\n};\r\n\r\nconst button = {\r\n  backgroundColor: '#3b82f6',\r\n  borderRadius: '6px',\r\n  color: '#fff',\r\n  fontSize: '16px',\r\n  fontWeight: 'bold',\r\n  textDecoration: 'none',\r\n  textAlign: 'center' as const,\r\n  display: 'inline-block',\r\n  padding: '12px 32px',\r\n};\r\n\r\nconst secondaryButton = {\r\n  backgroundColor: '#6b7280',\r\n  borderRadius: '6px',\r\n  color: '#fff',\r\n  fontSize: '14px',\r\n  fontWeight: '600',\r\n  textDecoration: 'none',\r\n  textAlign: 'center' as const,\r\n  display: 'inline-block',\r\n  padding: '10px 24px',\r\n};\r\n\r\nconst hr = {\r\n  borderColor: '#e6e6e6',\r\n  margin: '20px 0',\r\n};\r\n\r\nconst footer = {\r\n  color: '#8898aa',\r\n  fontSize: '12px',\r\n  lineHeight: '16px',\r\n  padding: '0 40px',\r\n  marginTop: '32px',\r\n};\r\n"],"names":[],"mappings":"AAAA,kCAAkC;;;;;;;;;;;;;;;;;;;AAuB3B,MAAM,uBAAuB,CAAC,EACnC,WAAW,QAAQ,EACnB,OAAO,EACP,gBAAgB,EAChB,WAAW,EACX,YAAY,EACc;IAC1B,MAAM,cAAc,CAAC,2BAA2B,EAAE,QAAQ,WAAW,CAAC;IAEtE,qBACE,0PAAC,4JAAA,CAAA,OAAI;;0BACH,0PAAC,4JAAA,CAAA,OAAI;;;;;0BACL,0PAAC,+JAAA,CAAA,UAAO;0BAAE;;;;;;0BACV,0PAAC,4JAAA,CAAA,OAAI;gBAAC,OAAO;0BACX,cAAA,0PAAC,iKAAA,CAAA,YAAS;oBAAC,OAAO;;sCAChB,0PAAC,+JAAA,CAAA,UAAO;4BAAC,OAAO;sCAAI;;;;;;sCAEpB,0PAAC,4JAAA,CAAA,OAAI;4BAAC,OAAO;;gCAAM;gCACV;gCAAS;;;;;;;sCAGlB,0PAAC,4JAAA,CAAA,OAAI;4BAAC,OAAO;sCAAM;;;;;;sCAInB,0PAAC,+JAAA,CAAA,UAAO;4BAAC,OAAO;;8CACd,0PAAC,+JAAA,CAAA,UAAO;oCAAC,OAAO;;wCAAI;wCAAI;;;;;;;8CACxB,0PAAC,4JAAA,CAAA,OAAI;oCAAC,OAAO;;sDACX,0PAAC;sDAAO;;;;;;wCAAiC;wCAAM,iBAAiB,OAAO,CAAC;wCAAG;;;;;;;;;;;;;sCAI/E,0PAAC,+JAAA,CAAA,UAAO;4BAAC,OAAO;sCACd,cAAA,0PAAC,8JAAA,CAAA,SAAM;gCAAC,OAAO;gCAAQ,MAAM;0CAAa;;;;;;;;;;;sCAK5C,0PAAC,+JAAA,CAAA,UAAO;4BAAC,OAAO;;8CACd,0PAAC,+JAAA,CAAA,UAAO;oCAAC,OAAO;8CAAI;;;;;;8CACpB,0PAAC,4JAAA,CAAA,OAAI;oCAAC,OAAO;8CAAiB;;;;;;8CAG9B,0PAAC,4JAAA,CAAA,OAAI;oCAAC,OAAO;;wCAAiB;sDACrB,0PAAC;sDAAO;;;;;;wCAAmC;;;;;;;8CAEpD,0PAAC,4JAAA,CAAA,OAAI;oCAAC,OAAO;8CAAiB;;;;;;8CAG9B,0PAAC,4JAAA,CAAA,OAAI;oCAAC,OAAO;8CAAiB;;;;;;;;;;;;sCAKhC,0PAAC,+JAAA,CAAA,UAAO;4BAAC,OAAO;sCACd,cAAA,0PAAC,8JAAA,CAAA,SAAM;gCAAC,OAAO;gCAAiB,MAAM;0CAAc;;;;;;;;;;;sCAKtD,0PAAC,0JAAA,CAAA,KAAE;4BAAC,OAAO;;;;;;sCAEX,0PAAC,4JAAA,CAAA,OAAI;4BAAC,OAAO;;gCAAQ;8CAEnB,0PAAC;;;;;gCAAK;;;;;;;;;;;;;;;;;;;;;;;;AAOlB;uCAEe;AAEf,SAAS;AACT,MAAM,OAAO;IACX,iBAAiB;IACjB,YACE;AACJ;AAEA,MAAM,YAAY;IAChB,iBAAiB;IACjB,QAAQ;IACR,SAAS;IACT,cAAc;IACd,UAAU;AACZ;AAEA,MAAM,KAAK;IACT,OAAO;IACP,UAAU;IACV,YAAY;IACZ,QAAQ;IACR,SAAS;IACT,YAAY;AACd;AAEA,MAAM,KAAK;IACT,OAAO;IACP,UAAU;IACV,YAAY;IACZ,QAAQ;AACV;AAEA,MAAM,KAAK;IACT,OAAO;IACP,UAAU;IACV,YAAY;IACZ,QAAQ;AACV;AAEA,MAAM,OAAO;IACX,OAAO;IACP,UAAU;IACV,YAAY;IACZ,SAAS;AACX;AAEA,MAAM,UAAU;IACd,iBAAiB;IACjB,QAAQ;IACR,cAAc;IACd,QAAQ;IACR,SAAS;AACX;AAEA,MAAM,WAAW;IACf,OAAO;IACP,UAAU;IACV,YAAY;IACZ,QAAQ;AACV;AAEA,MAAM,iBAAiB;IACrB,iBAAiB;IACjB,QAAQ;IACR,cAAc;IACd,QAAQ;IACR,SAAS;AACX;AAEA,MAAM,kBAAkB;IACtB,OAAO;IACP,UAAU;IACV,YAAY;IACZ,QAAQ;AACV;AAEA,MAAM,kBAAkB;IACtB,SAAS;IACT,WAAW;AACb;AAEA,MAAM,SAAS;IACb,iBAAiB;IACjB,cAAc;IACd,OAAO;IACP,UAAU;IACV,YAAY;IACZ,gBAAgB;IAChB,WAAW;IACX,SAAS;IACT,SAAS;AACX;AAEA,MAAM,kBAAkB;IACtB,iBAAiB;IACjB,cAAc;IACd,OAAO;IACP,UAAU;IACV,YAAY;IACZ,gBAAgB;IAChB,WAAW;IACX,SAAS;IACT,SAAS;AACX;AAEA,MAAM,KAAK;IACT,aAAa;IACb,QAAQ;AACV;AAEA,MAAM,SAAS;IACb,OAAO;IACP,UAAU;IACV,YAAY;IACZ,SAAS;IACT,WAAW;AACb"}},
    {"offset": {"line": 827, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 832, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/src/emails/letter-with-attachment.tsx"],"sourcesContent":["// src/emails/letter-with-attachment.tsx\r\nimport {\r\n  Body,\r\n  Button,\r\n  Container,\r\n  Head,\r\n  Heading,\r\n  Html,\r\n  Preview,\r\n  Section,\r\n  Text,\r\n  Hr,\r\n} from '@react-email/components';\r\nimport * as React from 'react';\r\n\r\ninterface LetterWithAttachmentEmailProps {\r\n  userName?: string;\r\n  address: string;\r\n  monthlyReduction: number;\r\n  dashboardUrl: string;\r\n}\r\n\r\nexport const LetterWithAttachmentEmail = ({\r\n  userName = 'Mieter',\r\n  address,\r\n  monthlyReduction,\r\n  dashboardUrl,\r\n}: LetterWithAttachmentEmailProps) => {\r\n  const previewText = `Ihr Herabsetzungsbrief f√ºr ${address} ist im Anhang`;\r\n\r\n  return (\r\n    <Html>\r\n      <Head />\r\n      <Preview>{previewText}</Preview>\r\n      <Body style={main}>\r\n        <Container style={container}>\r\n          <Heading style={h1}>üìÑ Ihr Herabsetzungsbrief</Heading>\r\n\r\n          <Text style={text}>\r\n            Hallo {userName},\r\n          </Text>\r\n\r\n          <Text style={text}>\r\n            Ihr offizieller Herabsetzungsbrief ist im <strong>Anhang dieser E-Mail</strong> als PDF-Datei enthalten.\r\n          </Text>\r\n\r\n          <Section style={infoBox}>\r\n            <Heading style={h2}>üìç {address}</Heading>\r\n            <Text style={infoText}>\r\n              <strong>Beantragte Herabsetzung:</strong> CHF {monthlyReduction.toFixed(2)} / Monat\r\n            </Text>\r\n          </Section>\r\n\r\n          <Section style={instructionBox}>\r\n            <Heading style={h3}>üìÆ N√§chste Schritte:</Heading>\r\n            <Text style={instructionText}>\r\n              1. <strong>PDF √∂ffnen und ausdrucken</strong> (siehe Anhang)\r\n            </Text>\r\n            <Text style={instructionText}>\r\n              2. <strong>Brief unterschreiben</strong> (unten auf Seite 1)\r\n            </Text>\r\n            <Text style={instructionText}>\r\n              3. Per <strong>A-Post Plus (Einschreiben)</strong> an Vermieter senden\r\n            </Text>\r\n            <Text style={instructionText}>\r\n              4. <strong>Kopie und Einschreibe-Beleg aufbewahren</strong>\r\n            </Text>\r\n            <Text style={instructionText}>\r\n              5. Auf Antwort des Vermieters warten (30 Tage Frist)\r\n            </Text>\r\n          </Section>\r\n\r\n          <Section style={tipBox}>\r\n            <Heading style={h3}>üí° Wichtiger Tipp:</Heading>\r\n            <Text style={tipText}>\r\n              Der Versand per <strong>A-Post Plus (Einschreiben)</strong> ist wichtig, um den Zugang rechtlich nachweisen zu k√∂nnen.\r\n              Sie erhalten einen Einschreibe-Beleg als Nachweis.\r\n            </Text>\r\n            <Text style={tipText}>\r\n              Kosten: ca. CHF 2.50 zus√§tzlich zur normalen Briefmarke.\r\n            </Text>\r\n          </Section>\r\n\r\n          <Section style={buttonContainer}>\r\n            <Button style={button} href={dashboardUrl}>\r\n              Zum Dashboard\r\n            </Button>\r\n          </Section>\r\n\r\n          <Hr style={hr} />\r\n\r\n          <Text style={footer}>\r\n            MietCheck.ch - Ihr Mietrechts-Assistent\r\n            <br />\r\n            Diese Email wurde automatisch generiert.\r\n            <br />\r\n            <br />\r\n            Bei Fragen erreichen Sie uns unter info@mietcheck-app.ch\r\n          </Text>\r\n        </Container>\r\n      </Body>\r\n    </Html>\r\n  );\r\n};\r\n\r\nexport default LetterWithAttachmentEmail;\r\n\r\n// Styles\r\nconst main = {\r\n  backgroundColor: '#f6f9fc',\r\n  fontFamily:\r\n    '-apple-system,BlinkMacSystemFont,\"Segoe UI\",Roboto,\"Helvetica Neue\",Ubuntu,sans-serif',\r\n};\r\n\r\nconst container = {\r\n  backgroundColor: '#ffffff',\r\n  margin: '0 auto',\r\n  padding: '20px 0 48px',\r\n  marginBottom: '64px',\r\n  maxWidth: '600px',\r\n};\r\n\r\nconst h1 = {\r\n  color: '#1a1a1a',\r\n  fontSize: '28px',\r\n  fontWeight: 'bold',\r\n  margin: '40px 0',\r\n  padding: '0 40px',\r\n  lineHeight: '1.4',\r\n};\r\n\r\nconst h2 = {\r\n  color: '#1a1a1a',\r\n  fontSize: '20px',\r\n  fontWeight: '600',\r\n  margin: '0 0 15px',\r\n};\r\n\r\nconst h3 = {\r\n  color: '#1a1a1a',\r\n  fontSize: '18px',\r\n  fontWeight: '600',\r\n  margin: '0 0 16px',\r\n};\r\n\r\nconst text = {\r\n  color: '#444',\r\n  fontSize: '16px',\r\n  lineHeight: '26px',\r\n  padding: '0 40px',\r\n  marginBottom: '16px',\r\n};\r\n\r\nconst infoBox = {\r\n  backgroundColor: '#f0fdf4',\r\n  border: '2px solid #16a34a',\r\n  borderRadius: '8px',\r\n  margin: '24px 40px',\r\n  padding: '24px',\r\n};\r\n\r\nconst infoText = {\r\n  color: '#444',\r\n  fontSize: '16px',\r\n  lineHeight: '24px',\r\n  margin: '8px 0',\r\n};\r\n\r\nconst instructionBox = {\r\n  backgroundColor: '#fef3c7',\r\n  border: '1px solid #f59e0b',\r\n  borderRadius: '8px',\r\n  margin: '24px 40px',\r\n  padding: '24px',\r\n};\r\n\r\nconst instructionText = {\r\n  color: '#444',\r\n  fontSize: '15px',\r\n  lineHeight: '28px',\r\n  margin: '8px 0',\r\n};\r\n\r\nconst tipBox = {\r\n  backgroundColor: '#eff6ff',\r\n  border: '1px solid #3b82f6',\r\n  borderRadius: '8px',\r\n  margin: '24px 40px',\r\n  padding: '24px',\r\n};\r\n\r\nconst tipText = {\r\n  color: '#444',\r\n  fontSize: '14px',\r\n  lineHeight: '22px',\r\n  margin: '8px 0',\r\n};\r\n\r\nconst buttonContainer = {\r\n  padding: '27px 40px',\r\n  textAlign: 'center' as const,\r\n};\r\n\r\nconst button = {\r\n  backgroundColor: '#3b82f6',\r\n  borderRadius: '6px',\r\n  color: '#fff',\r\n  fontSize: '16px',\r\n  fontWeight: 'bold',\r\n  textDecoration: 'none',\r\n  textAlign: 'center' as const,\r\n  display: 'inline-block',\r\n  padding: '12px 32px',\r\n};\r\n\r\nconst hr = {\r\n  borderColor: '#e6e6e6',\r\n  margin: '20px 0',\r\n};\r\n\r\nconst footer = {\r\n  color: '#8898aa',\r\n  fontSize: '12px',\r\n  lineHeight: '16px',\r\n  padding: '0 40px',\r\n  marginTop: '32px',\r\n};\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1261, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 1266, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/src/emails/welcome.tsx"],"sourcesContent":["// src/emails/welcome.tsx\r\nimport {\r\n  Body,\r\n  Button,\r\n  Container,\r\n  Head,\r\n  Heading,\r\n  Html,\r\n  Preview,\r\n  Section,\r\n  Text,\r\n  Hr,\r\n} from '@react-email/components';\r\nimport * as React from 'react';\r\n\r\ninterface WelcomeEmailProps {\r\n  userName?: string;\r\n  userEmail: string;\r\n  loginUrl: string;\r\n}\r\n\r\nexport const WelcomeEmail = ({\r\n  userName,\r\n  userEmail,\r\n  loginUrl,\r\n}: WelcomeEmailProps) => {\r\n  const displayName = userName || userEmail;\r\n  const previewText = 'Willkommen bei MietCheck.ch - Ihr Mietrechts-Assistent';\r\n\r\n  return (\r\n    <Html>\r\n      <Head />\r\n      <Preview>{previewText}</Preview>\r\n      <Body style={main}>\r\n        <Container style={container}>\r\n          <Heading style={h1}>üè† Willkommen bei MietCheck.ch</Heading>\r\n\r\n          <Text style={text}>\r\n            Hallo {displayName},\r\n          </Text>\r\n\r\n          <Text style={text}>\r\n            Vielen Dank f√ºr Ihre Registrierung! Wir freuen uns, Sie bei MietCheck.ch begr√º√üen zu d√ºrfen.\r\n          </Text>\r\n\r\n          <Section style={featureBox}>\r\n            <Heading style={h2}>Was Sie jetzt tun k√∂nnen:</Heading>\r\n\r\n            <Text style={featureText}>\r\n              ‚úÖ <strong>Mietvertrag analysieren</strong> - Laden Sie Ihren Vertrag hoch\r\n            </Text>\r\n            <Text style={featureText}>\r\n              ‚úÖ <strong>Herabsetzung berechnen</strong> - Basierend auf dem Referenzzins\r\n            </Text>\r\n            <Text style={featureText}>\r\n              ‚úÖ <strong>Brief generieren</strong> - Offizieller Herabsetzungsbrief\r\n            </Text>\r\n            <Text style={featureText}>\r\n              ‚úÖ <strong>Vertr√§ge verwalten</strong> - Alle Analysen in Ihrem Dashboard\r\n            </Text>\r\n          </Section>\r\n\r\n          <Section style={buttonContainer}>\r\n            <Button style={button} href={loginUrl}>\r\n              Zum Dashboard\r\n            </Button>\r\n          </Section>\r\n\r\n          <Section style={infoBox}>\r\n            <Heading style={h3}>üí° Wussten Sie?</Heading>\r\n            <Text style={infoText}>\r\n              Der Referenzzins ist aktuell bei <strong>1.25%</strong>. Wenn Ihr Vertrag eine\r\n              Referenzzins-Klausel enth√§lt und bei einem h√∂heren Zinssatz abgeschlossen wurde,\r\n              haben Sie m√∂glicherweise Anspruch auf eine Mietzinsreduktion.\r\n            </Text>\r\n          </Section>\r\n\r\n          <Hr style={hr} />\r\n\r\n          <Text style={footer}>\r\n            MietCheck.ch - Ihr Mietrechts-Assistent\r\n            <br />\r\n            Bei Fragen erreichen Sie uns unter info@mietcheck-app.ch\r\n          </Text>\r\n        </Container>\r\n      </Body>\r\n    </Html>\r\n  );\r\n};\r\n\r\nexport default WelcomeEmail;\r\n\r\n// Styles\r\nconst main = {\r\n  backgroundColor: '#f6f9fc',\r\n  fontFamily:\r\n    '-apple-system,BlinkMacSystemFont,\"Segoe UI\",Roboto,\"Helvetica Neue\",Ubuntu,sans-serif',\r\n};\r\n\r\nconst container = {\r\n  backgroundColor: '#ffffff',\r\n  margin: '0 auto',\r\n  padding: '20px 0 48px',\r\n  marginBottom: '64px',\r\n  maxWidth: '600px',\r\n};\r\n\r\nconst h1 = {\r\n  color: '#1a1a1a',\r\n  fontSize: '28px',\r\n  fontWeight: 'bold',\r\n  margin: '40px 0',\r\n  padding: '0 40px',\r\n  lineHeight: '1.4',\r\n};\r\n\r\nconst h2 = {\r\n  color: '#1a1a1a',\r\n  fontSize: '20px',\r\n  fontWeight: '600',\r\n  margin: '0 0 16px',\r\n};\r\n\r\nconst h3 = {\r\n  color: '#1a1a1a',\r\n  fontSize: '18px',\r\n  fontWeight: '600',\r\n  margin: '0 0 12px',\r\n};\r\n\r\nconst text = {\r\n  color: '#444',\r\n  fontSize: '16px',\r\n  lineHeight: '26px',\r\n  padding: '0 40px',\r\n  marginBottom: '16px',\r\n};\r\n\r\nconst featureBox = {\r\n  backgroundColor: '#f0f9ff',\r\n  borderRadius: '8px',\r\n  margin: '24px 40px',\r\n  padding: '24px',\r\n};\r\n\r\nconst featureText = {\r\n  color: '#444',\r\n  fontSize: '15px',\r\n  lineHeight: '28px',\r\n  margin: '8px 0',\r\n};\r\n\r\nconst infoBox = {\r\n  backgroundColor: '#fef3c7',\r\n  borderRadius: '8px',\r\n  margin: '24px 40px',\r\n  padding: '24px',\r\n};\r\n\r\nconst infoText = {\r\n  color: '#444',\r\n  fontSize: '14px',\r\n  lineHeight: '22px',\r\n  margin: '0',\r\n};\r\n\r\nconst buttonContainer = {\r\n  padding: '27px 40px',\r\n  textAlign: 'center' as const,\r\n};\r\n\r\nconst button = {\r\n  backgroundColor: '#3b82f6',\r\n  borderRadius: '6px',\r\n  color: '#fff',\r\n  fontSize: '16px',\r\n  fontWeight: 'bold',\r\n  textDecoration: 'none',\r\n  textAlign: 'center' as const,\r\n  display: 'inline-block',\r\n  padding: '12px 32px',\r\n};\r\n\r\nconst hr = {\r\n  borderColor: '#e6e6e6',\r\n  margin: '20px 0',\r\n};\r\n\r\nconst footer = {\r\n  color: '#8898aa',\r\n  fontSize: '12px',\r\n  lineHeight: '16px',\r\n  padding: '0 40px',\r\n  marginTop: '32px',\r\n};\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1606, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 1611, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/src/lib/email-service.ts"],"sourcesContent":["// src/lib/email-service.ts\r\nimport { Resend } from 'resend';\r\nimport { render } from '@react-email/render';\r\nimport AnalysisCompleteEmail from '@/emails/analysis-complete';\r\nimport LetterGeneratedEmail from '@/emails/letter-generated';\r\nimport LetterWithAttachmentEmail from '@/emails/letter-with-attachment';\r\nimport WelcomeEmail from '@/emails/welcome';\r\n\r\n// Initialize Resend with API key from environment\r\nconst resend = new Resend(process.env.RESEND_API_KEY);\r\n\r\n// Email sender configuration\r\nconst FROM_EMAIL = process.env.EMAIL_FROM || 'noreply@mietcheck-app.ch';\r\nconst FROM_NAME = 'MietCheck';\r\n\r\nexport type EmailType =\r\n  | 'analysis-complete'\r\n  | 'letter-generated'\r\n  | 'letter-with-attachment'\r\n  | 'welcome';\r\n\r\ninterface BaseEmailData {\r\n  to: string;\r\n  userName?: string;\r\n}\r\n\r\ninterface AnalysisCompleteData extends BaseEmailData {\r\n  address: string;\r\n  currentRent: number;\r\n  newRent: number;\r\n  monthlyReduction: number;\r\n  yearlyReduction: number;\r\n  contractId?: string;\r\n}\r\n\r\ninterface LetterGeneratedData extends BaseEmailData {\r\n  address: string;\r\n  monthlyReduction: number;\r\n  downloadUrl: string;\r\n  contractId?: string;\r\n}\r\n\r\ninterface LetterWithAttachmentData extends BaseEmailData {\r\n  address: string;\r\n  monthlyReduction: number;\r\n  pdfBuffer: Buffer;\r\n  pdfFilename?: string;\r\n  contractId?: string;\r\n}\r\n\r\ninterface WelcomeData extends BaseEmailData {\r\n  userEmail: string;\r\n}\r\n\r\nexport type EmailData =\r\n  | { type: 'analysis-complete'; data: AnalysisCompleteData }\r\n  | { type: 'letter-generated'; data: LetterGeneratedData }\r\n  | { type: 'letter-with-attachment'; data: LetterWithAttachmentData }\r\n  | { type: 'welcome'; data: WelcomeData };\r\n\r\n/**\r\n * Send an email using Resend\r\n */\r\nexport async function sendEmail(emailData: EmailData) {\r\n  try {\r\n    // Check if Resend is configured\r\n    if (!process.env.RESEND_API_KEY) {\r\n      console.warn('‚ö†Ô∏è RESEND_API_KEY not configured, email not sent');\r\n      return {\r\n        success: false,\r\n        error: 'Email service not configured',\r\n      };\r\n    }\r\n\r\n    const { type, data } = emailData;\r\n    let subject: string;\r\n    let html: string;\r\n    const baseUrl = process.env.NEXT_PUBLIC_BASE_URL || 'https://mietcheck-app.ch';\r\n\r\n    switch (type) {\r\n      case 'analysis-complete': {\r\n        const { address, currentRent, newRent, monthlyReduction, yearlyReduction, contractId } = data as AnalysisCompleteData;\r\n        const dashboardUrl = contractId\r\n          ? `${baseUrl}/dashboard?contract=${contractId}`\r\n          : `${baseUrl}/dashboard`;\r\n\r\n        subject = `‚úÖ Analyse abgeschlossen: ${address}`;\r\n        html = await render(\r\n          AnalysisCompleteEmail({\r\n            userName: data.userName,\r\n            address,\r\n            currentRent,\r\n            newRent,\r\n            monthlyReduction,\r\n            yearlyReduction,\r\n            dashboardUrl,\r\n          })\r\n        );\r\n        break;\r\n      }\r\n\r\n      case 'letter-generated': {\r\n        const { address, monthlyReduction, downloadUrl, contractId } = data as LetterGeneratedData;\r\n        const dashboardUrl = contractId\r\n          ? `${baseUrl}/dashboard?contract=${contractId}`\r\n          : `${baseUrl}/dashboard`;\r\n\r\n        subject = `üìÑ Herabsetzungsbrief bereit: ${address}`;\r\n        html = await render(\r\n          LetterGeneratedEmail({\r\n            userName: data.userName,\r\n            address,\r\n            monthlyReduction,\r\n            downloadUrl,\r\n            dashboardUrl,\r\n          })\r\n        );\r\n        break;\r\n      }\r\n\r\n      case 'letter-with-attachment': {\r\n        const { address, monthlyReduction, pdfBuffer, pdfFilename, contractId } = data as LetterWithAttachmentData;\r\n        const dashboardUrl = contractId\r\n          ? `${baseUrl}/dashboard?contract=${contractId}`\r\n          : `${baseUrl}/dashboard`;\r\n\r\n        subject = `üìÑ Ihr Herabsetzungsbrief: ${address}`;\r\n        html = await render(\r\n          LetterWithAttachmentEmail({\r\n            userName: data.userName,\r\n            address,\r\n            monthlyReduction,\r\n            dashboardUrl,\r\n          })\r\n        );\r\n\r\n        // Send email with PDF attachment\r\n        const filename = pdfFilename || 'herabsetzungsbegehren.pdf';\r\n        const result = await resend.emails.send({\r\n          from: `${FROM_NAME} <${FROM_EMAIL}>`,\r\n          to: data.to,\r\n          subject,\r\n          html,\r\n          attachments: [\r\n            {\r\n              filename,\r\n              content: pdfBuffer,\r\n            },\r\n          ],\r\n        });\r\n\r\n        if (result.error) {\r\n          console.error('‚ùå Email send error:', result.error);\r\n          return {\r\n            success: false,\r\n            error: result.error.message,\r\n          };\r\n        }\r\n\r\n        console.log('‚úÖ Email with PDF attachment sent:', {\r\n          type,\r\n          to: data.to,\r\n          id: result.data?.id,\r\n          attachment: filename,\r\n        });\r\n\r\n        return {\r\n          success: true,\r\n          id: result.data?.id,\r\n        };\r\n      }\r\n\r\n      case 'welcome': {\r\n        const { userEmail } = data as WelcomeData;\r\n        const loginUrl = `${baseUrl}/dashboard`;\r\n\r\n        subject = 'üè† Willkommen bei MietCheck.ch';\r\n        html = await render(\r\n          WelcomeEmail({\r\n            userName: data.userName,\r\n            userEmail,\r\n            loginUrl,\r\n          })\r\n        );\r\n        break;\r\n      }\r\n\r\n      default:\r\n        throw new Error(`Unknown email type: ${type}`);\r\n    }\r\n\r\n    // Send email via Resend\r\n    const result = await resend.emails.send({\r\n      from: `${FROM_NAME} <${FROM_EMAIL}>`,\r\n      to: data.to,\r\n      subject,\r\n      html,\r\n    });\r\n\r\n    if (result.error) {\r\n      console.error('‚ùå Email send error:', result.error);\r\n      return {\r\n        success: false,\r\n        error: result.error.message,\r\n      };\r\n    }\r\n\r\n    console.log('‚úÖ Email sent successfully:', {\r\n      type,\r\n      to: data.to,\r\n      id: result.data?.id,\r\n    });\r\n\r\n    return {\r\n      success: true,\r\n      id: result.data?.id,\r\n    };\r\n\r\n  } catch (error: any) {\r\n    console.error('‚ùå Email service error:', error);\r\n    return {\r\n      success: false,\r\n      error: error.message || 'Failed to send email',\r\n    };\r\n  }\r\n}\r\n\r\n/**\r\n * Send analysis complete notification\r\n */\r\nexport async function sendAnalysisCompleteEmail(data: AnalysisCompleteData) {\r\n  return sendEmail({\r\n    type: 'analysis-complete',\r\n    data,\r\n  });\r\n}\r\n\r\n/**\r\n * Send letter generated notification\r\n */\r\nexport async function sendLetterGeneratedEmail(data: LetterGeneratedData) {\r\n  return sendEmail({\r\n    type: 'letter-generated',\r\n    data,\r\n  });\r\n}\r\n\r\n/**\r\n * Send letter with PDF attachment\r\n */\r\nexport async function sendLetterWithAttachmentEmail(data: LetterWithAttachmentData) {\r\n  return sendEmail({\r\n    type: 'letter-with-attachment',\r\n    data,\r\n  });\r\n}\r\n\r\n/**\r\n * Send welcome email\r\n */\r\nexport async function sendWelcomeEmail(data: WelcomeData) {\r\n  return sendEmail({\r\n    type: 'welcome',\r\n    data,\r\n  });\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1795, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 1800, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/src/app/api/register/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\r\nimport { createUser, createContract, getUser } from '@/lib/db';\r\nimport { sendWelcomeEmail } from '@/lib/email-service';\r\nimport bcrypt from 'bcryptjs';\r\n\r\nexport async function POST(request: NextRequest) {\r\n  try {\r\n    const body = await request.json();\r\n    const { email, name, address, netRent, referenceRate, contractDate } = body;\r\n\r\n    // Validation\r\n    if (!email || !address || !netRent || !referenceRate || !contractDate) {\r\n      return NextResponse.json(\r\n        { error: 'Alle Pflichtfelder m√ºssen ausgef√ºllt werden' },\r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    // Check if user exists\r\n    const existingUser = await getUser(email);\r\n    \r\n    let userId: number;\r\n    \r\n    if (existingUser) {\r\n      userId = existingUser.id;\r\n    } else {\r\n      // Create new user with random password (they can reset it later)\r\n      const randomPassword = Math.random().toString(36).slice(-8);\r\n      const passwordHash = await bcrypt.hash(randomPassword, 10);\r\n      const newUser = await createUser(email, passwordHash, name);\r\n      userId = newUser.id;\r\n    }\r\n\r\n    // Create contract\r\n    await createContract(userId, {\r\n      address,\r\n      netRent: parseFloat(netRent),\r\n      referenceRate: parseFloat(referenceRate),\r\n      contractDate,\r\n      landlordName: '',\r\n      landlordAddress: '',\r\n    });\r\n\r\n    // Send welcome email (async, don't block registration)\r\n    if (!existingUser) {\r\n      sendWelcomeEmail({\r\n        to: email,\r\n        userName: name,\r\n        userEmail: email,\r\n      }).catch((error) => {\r\n        console.error('Failed to send welcome email:', error);\r\n        // Don't fail registration if email fails\r\n      });\r\n    }\r\n\r\n    return NextResponse.json({\r\n      success: true,\r\n      message: 'Registrierung erfolgreich! Du erh√§ltst eine E-Mail sobald der Referenzzinssatz sinkt.',\r\n    });\r\n  } catch (error: any) {\r\n    console.error('Registration error:', error);\r\n    return NextResponse.json(\r\n      { error: 'Fehler bei der Registrierung: ' + error.message },\r\n      { status: 500 }\r\n    );\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;;;AAKO,eAAe,KAAK,OAAoB;IAC7C,IAAI;QACF,MAAM,OAAO,MAAM,QAAQ,IAAI;QAC/B,MAAM,EAAE,KAAK,EAAE,IAAI,EAAE,OAAO,EAAE,OAAO,EAAE,aAAa,EAAE,YAAY,EAAE,GAAG;QAEvE,aAAa;QACb,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC,WAAW,CAAC,iBAAiB,CAAC,cAAc;YACrE,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAA8C,GACvD;gBAAE,QAAQ;YAAI;QAElB;QAEA,uBAAuB;QACvB,MAAM,eAAe,MAAM,CAAA,GAAA,kHAAA,CAAA,UAAO,AAAD,EAAE;QAEnC,IAAI;QAEJ,IAAI,cAAc;YAChB,SAAS,aAAa,EAAE;QAC1B,OAAO;YACL,iEAAiE;YACjE,MAAM,iBAAiB,KAAK,MAAM,GAAG,QAAQ,CAAC,IAAI,KAAK,CAAC,CAAC;YACzD,MAAM,eAAe,MAAM,mIAAA,CAAA,UAAM,CAAC,IAAI,CAAC,gBAAgB;YACvD,MAAM,UAAU,MAAM,CAAA,GAAA,kHAAA,CAAA,aAAU,AAAD,EAAE,OAAO,cAAc;YACtD,SAAS,QAAQ,EAAE;QACrB;QAEA,kBAAkB;QAClB,MAAM,CAAA,GAAA,kHAAA,CAAA,iBAAc,AAAD,EAAE,QAAQ;YAC3B;YACA,SAAS,WAAW;YACpB,eAAe,WAAW;YAC1B;YACA,cAAc;YACd,iBAAiB;QACnB;QAEA,uDAAuD;QACvD,IAAI,CAAC,cAAc;YACjB,CAAA,GAAA,gIAAA,CAAA,mBAAgB,AAAD,EAAE;gBACf,IAAI;gBACJ,UAAU;gBACV,WAAW;YACb,GAAG,KAAK,CAAC,CAAC;gBACR,QAAQ,KAAK,CAAC,iCAAiC;YAC/C,yCAAyC;YAC3C;QACF;QAEA,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;YACvB,SAAS;YACT,SAAS;QACX;IACF,EAAE,OAAO,OAAY;QACnB,QAAQ,KAAK,CAAC,uBAAuB;QACrC,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CACtB;YAAE,OAAO,mCAAmC,MAAM,OAAO;QAAC,GAC1D;YAAE,QAAQ;QAAI;IAElB;AACF"}},
    {"offset": {"line": 1869, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}