(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[241],{7591:function(e,t,s){Promise.resolve().then(s.bind(s,9379))},9379:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return N}});var n=s(7437),a=s(2265),r=s(9376),l=s(7648),i=s(3428),d=s(9064);let o=e=>{d.ZP.success(e)},c=e=>{d.ZP.error(e)},u=e=>d.ZP.loading(e),h=e=>{d.ZP.dismiss(e)},g={uploadStart:"Dokument wird hochgeladen...",analysisStart:"Vertrag wird analysiert...",analysisSuccess:"Analyse abgeschlossen",networkError:"Netzwerkfehler. Bitte Internetverbindung pr\xfcfen.",genericError:"Ein Fehler ist aufgetreten. Bitte erneut versuchen."};async function m(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{maxRetries:s=3,delay:n=1e3,onRetry:a}=t,r=null;for(let t=1;t<=s;t++)try{return await e()}catch(e){r=e instanceof Error?e:Error(String(e)),t<s&&(null==a||a(t),d.ZP.loading("Versuch ".concat(t+1," von ").concat(s,"..."),{duration:n}),await new Promise(e=>setTimeout(e,n)))}throw r}let x=["application/pdf","image/jpeg","image/png","image/jpg"],p=[".pdf",".jpg",".jpeg",".png"];function b(e){let{onAnalysisComplete:t}=e,[s,r]=(0,a.useState)(!1),[l,d]=(0,a.useState)(!1),[b,f]=(0,a.useState)(0),[y,j]=(0,a.useState)(""),D=(0,a.useRef)(null),N=e=>{var t;if(e.size>10485760)return"Datei ist zu gross (".concat((e.size/1024/1024).toFixed(1)," MB). Maximum: 10 MB");let s="."+(null===(t=e.name.split(".").pop())||void 0===t?void 0:t.toLowerCase());return x.includes(e.type)||p.includes(s)?0===e.size?"Die Datei ist leer. Bitte w\xe4hlen Sie eine andere Datei.":null:"Ung\xfcltiges Dateiformat: ".concat(e.type||s,". Erlaubt: PDF, JPG, PNG")},z=()=>{r(!1),d(!1),f(0),D.current&&(D.current.value="")},v=async e=>{var s,n,a,l,x,p;let b=null===(s=e.target.files)||void 0===s?void 0:s[0];if(!b)return;let y=N(b);if(y){c(y),z();return}r(!0),f(10),j(b.name);let D=null;try{D=u(g.uploadStart),console.log("\uD83D\uDCE4 Uploading file:",b.name,b.type),f(20);let e=await (0,i.ws)(b.name,b,{access:"public",handleUploadUrl:"/api/upload-url"});h(D),console.log("✅ Upload successful:",e.url),f(40),r(!1),d(!0),D=u("Text wird extrahiert..."),console.log("\uD83D\uDD04 Processing upload with type:",b.type),f(50);let s=await m(async()=>{let t=await fetch("/api/process-upload",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({blobUrl:e.url,fileType:b.type})});if(!t.ok){let e=await t.json();throw Error(e.error||"Dateiverarbeitung fehlgeschlagen")}return t},{maxRetries:2,delay:1500});h(D),f(70);let{extractedText:n}=await s.json();if(console.log("✅ Text extracted, length:",null==n?void 0:n.length),!n||n.length<50)throw Error("Der Vertrag konnte nicht gelesen werden. Bitte stellen Sie sicher, dass das Dokument gut lesbar ist.");D=u(g.analysisStart),console.log("\uD83E\uDD16 Analyzing contract..."),f(80);let a=await m(async()=>{let e=await fetch("/api/analyze-contract",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({extractedText:n})});if(!e.ok){let t=await e.json();throw Error(t.error||"Analyse fehlgeschlagen")}return e},{maxRetries:2,delay:2e3});h(D),f(100);let l=await a.json();if(console.log("✅ Analysis complete:",l),!l.data&&!l.success)throw Error(l.error||"Analyse lieferte keine Daten");let c=l.data||l;o(g.analysisSuccess),t(c),d(!1)}catch(t){console.error("❌ Upload/Analysis error:",t),D&&h(D);let e=t.message||g.genericError;(null===(n=t.message)||void 0===n?void 0:n.includes("fetch"))||(null===(a=t.message)||void 0===a?void 0:a.includes("network"))?e=g.networkError:(null===(l=t.message)||void 0===l?void 0:l.includes("timeout"))?e="Die Analyse hat zu lange gedauert. Bitte versuchen Sie es mit einem kleineren Dokument.":((null===(x=t.message)||void 0===x?void 0:x.includes("rate limit"))||(null===(p=t.message)||void 0===p?void 0:p.includes("429")))&&(e="Zu viele Anfragen. Bitte warten Sie einen Moment und versuchen Sie es erneut."),c(e),z()}},w=s||l;return(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{className:"\n          border-2 border-dashed rounded-lg p-8 text-center transition-all duration-200\n          ".concat(w?"border-blue-300 bg-blue-50":"border-gray-300 hover:border-blue-500 hover:bg-gray-50","\n        "),onDragOver:e=>{e.preventDefault(),e.stopPropagation()},onDrop:e=>{e.preventDefault(),e.stopPropagation();let t=e.dataTransfer.files;if(t.length>0&&D.current){let e=new DataTransfer;e.items.add(t[0]),D.current.files=e.files;let s=new Event("change",{bubbles:!0});D.current.dispatchEvent(s)}},children:[(0,n.jsx)("input",{ref:D,type:"file",accept:".pdf,.jpg,.jpeg,.png",onChange:v,disabled:w,className:"hidden",id:"file-upload"}),(0,n.jsxs)("label",{htmlFor:"file-upload",className:"cursor-pointer block ".concat(w?"cursor-not-allowed":""),children:[(0,n.jsx)("div",{className:"text-6xl mb-4",children:s?"\uD83D\uDCE4":l?"\uD83E\uDD16":"\uD83D\uDCC4"}),(0,n.jsx)("div",{className:"text-lg font-medium text-gray-700 mb-2",children:s?"Wird hochgeladen...":l?"KI analysiert den Vertrag...":"Mietvertrag hochladen"}),(0,n.jsx)("div",{className:"text-sm text-gray-500",children:y?(0,n.jsx)("span",{className:"text-blue-600",children:y}):(0,n.jsxs)(n.Fragment,{children:["Klicken oder Datei hierher ziehen",(0,n.jsx)("br",{}),(0,n.jsx)("span",{className:"text-xs",children:"PDF, JPG oder PNG (max. 10 MB)"})]})})]})]}),w&&(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)("div",{className:"h-2 bg-gray-200 rounded-full overflow-hidden",children:(0,n.jsx)("div",{className:"h-full bg-blue-600 transition-all duration-500 ease-out",style:{width:"".concat(b,"%")}})}),(0,n.jsxs)("div",{className:"flex justify-between text-xs text-gray-500",children:[(0,n.jsxs)("span",{children:[b<40&&"Hochladen...",b>=40&&b<70&&"Text extrahieren...",b>=70&&b<100&&"KI-Analyse...",100===b&&"Fertig!"]}),(0,n.jsxs)("span",{children:[b,"%"]})]})]}),!w&&!y&&(0,n.jsxs)("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4 text-sm text-gray-600",children:[(0,n.jsx)("p",{className:"font-medium mb-2",children:"\uD83D\uDCA1 Tipps f\xfcr beste Ergebnisse:"}),(0,n.jsxs)("ul",{className:"list-disc list-inside space-y-1",children:[(0,n.jsx)("li",{children:"Verwenden Sie gut lesbare Scans oder Fotos"}),(0,n.jsx)("li",{children:"Stellen Sie sicher, dass alle Seiten gerade sind"}),(0,n.jsx)("li",{children:"Bei Fotos: Gute Beleuchtung ohne Schatten"})]})]})]})}let f=[{datum:"2025-09-02",satz:1.25},{datum:"2025-03-03",satz:1.5},{datum:"2023-12-01",satz:1.75},{datum:"2023-06-01",satz:1.5},{datum:"2022-12-01",satz:1.25},{datum:"2022-03-02",satz:1.25},{datum:"2020-03-02",satz:1.25},{datum:"2019-06-03",satz:1.25},{datum:"2017-06-01",satz:1.5},{datum:"2016-09-01",satz:1.5},{datum:"2015-09-01",satz:1.75}];function y(e,t,s){return Math.round(e*(1+(s-t)/.25*3/100)*100)/100}function j(e,t,s,n){let a=[],r=e,l=t,i=new Date(s),d=new Date(n);for(let e of f.filter(e=>{let t=new Date(e.datum);return t>i&&t<=d}).reverse())e.satz!==l&&(r=y(r,l,e.satz),l=e.satz,a.push({datum:e.datum,zins:l,miete:r}));return{sollMiete:r,schritte:a}}function D(e){let{vertragsbeginn:t,onHistorieChange:s,onValidationChange:r}=e,[l,d]=(0,a.useState)([]),[o,c]=(0,a.useState)(!1),[u,h]=(0,a.useState)(!1),[g,m]=(0,a.useState)(!1),[x,p]=(0,a.useState)(null),[b,D]=(0,a.useState)(""),[N,z]=(0,a.useState)(!1),[v,w]=(0,a.useState)(""),[C,S]=(0,a.useState)(""),[k,F]=(0,a.useState)(""),[R,M]=(0,a.useState)(""),[A,E]=(0,a.useState)([]),H={datum:t.datum,referenzzinssatz:t.referenzzinssatz,miete:t.miete,typ:"start"},B=l.length>0?l[l.length-1]:H,P=e=>{if(S(e),e&&!isNaN(parseFloat(e))){let t=B.referenzzinssatz;F(y(B.miete,t,parseFloat(e)).toFixed(2))}},I=async e=>{var t;let s=null===(t=e.target.files)||void 0===t?void 0:t[0];if(s){m(!0);try{console.log("\uD83D\uDCE4 Uploading adjustment document...");let e=await (0,i.ws)(s.name,s,{access:"public",handleUploadUrl:"/api/upload-url"});D(e.url),console.log("✅ Upload successful:",e.url),console.log("\uD83E\uDD16 Analyzing adjustment document...");let t=await fetch("/api/analyze-anpassung",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({blobUrl:e.url,fileType:s.type})});if(!t.ok)throw Error("Analyse fehlgeschlagen");let n=await t.json();console.log("✅ Analysis complete:",n),p(n.data)}catch(e){console.error("❌ Upload/Analysis error:",e),alert("Fehler: "+e.message)}finally{m(!1)}}},T=(e,t,s)=>{if(-1===e)return{label:"\uD83C\uDFE0 Mietbeginn",color:"text-blue-700"};if(null===s)return{label:"\uD83D\uDCDD Anpassung",color:"text-gray-600"};let n=t-s;return n>0?{label:"\uD83D\uDCC8 Erh\xf6hung (+".concat(n.toFixed(2)," CHF)"),color:"text-red-700"}:n<0?{label:"\uD83D\uDCC9 Mietreduzierung (".concat(n.toFixed(2)," CHF)"),color:"text-green-700"}:{label:"➡️ Keine \xc4nderung",color:"text-gray-600"}},G=e=>{let t=[...l,e].sort((e,t)=>new Date(e.datum).getTime()-new Date(t.datum).getTime());d(t),s({vertragsbeginn:H,anpassungen:t,aktuell:e})},U=e=>{let t=l.filter((t,s)=>s!==e);d(t),s({vertragsbeginn:H,anpassungen:t,aktuell:t.length>0?t[t.length-1]:H})},V=function(e){let t=[],s=[],n=[],a=[],r=[],l=[],i=[e.vertragsbeginn.datum,...e.anpassungen.map(e=>e.datum)];for(let e=1;e<i.length;e++)new Date(i[e])<=new Date(i[e-1])&&t.push("Datum ".concat(i[e]," ist nicht chronologisch nach ").concat(i[e-1]));let d=e.vertragsbeginn;for(let t=0;t<e.anpassungen.length;t++){let n=e.anpassungen[t];!function(e,t){let s=new Date(e),n=new Date(t);f.filter(e=>{let t=new Date(e.datum);return t>s&&t<=n}).reverse()}(d.datum,n.datum);let{sollMiete:i,schritte:o}=j(d.miete,d.referenzzinssatz,d.datum,n.datum),c=o.length>0?o[o.length-1].zins:d.referenzzinssatz;if(o.length>1){let e=o.slice(0,-1);r.push("Zwischen ".concat(new Date(d.datum).toLocaleDateString("de-CH")," ")+"und ".concat(new Date(n.datum).toLocaleDateString("de-CH")," ")+"wurden ".concat(e.length," Zins\xe4nderung(en) \xfcbersprungen: ")+e.map(e=>"".concat(new Date(e.datum).toLocaleDateString("de-CH"),": ").concat(e.zins,"%")).join(", "))}let u=n.referenzzinssatz-c,h=n.miete-i,g="korrekt",m="";Math.abs(h)>1?h>0?(g="zu_hoch",m="Miete ist CHF ".concat(h.toFixed(2)," zu hoch"),n.zusaetzlicheGruende&&n.zusaetzlicheGruende.length>0?s.push("Anpassung ".concat(new Date(n.datum).toLocaleDateString("de-CH"),": ")+"Miete CHF ".concat(n.miete.toFixed(2)," ist h\xf6her als Referenzzins-Berechnung ")+"(CHF ".concat(i.toFixed(2),"). Zus\xe4tzliche Gr\xfcnde: ").concat(n.zusaetzlicheGruende.join(", "),". ")+"Bitte pr\xfcfen Sie die Rechtm\xe4\xdfigkeit dieser Zusatzerh\xf6hung."):l.push("Anpassung ".concat(new Date(n.datum).toLocaleDateString("de-CH"),": ")+"Miete sollte CHF ".concat(i.toFixed(2)," sein (Referenzzins ").concat(c,"%), ")+"ist aber CHF ".concat(n.miete.toFixed(2)," (Referenzzins ").concat(n.referenzzinssatz,"%). ")+"Differenz: CHF ".concat(h.toFixed(2)," zu hoch! ")+"KEINE zus\xe4tzlichen Gr\xfcnde angegeben.")):(g="zu_niedrig",m="Miete ist CHF ".concat(Math.abs(h).toFixed(2)," zu niedrig (selten, aber m\xf6glich)")):m="Berechnung korrekt",a.push({datum:n.datum,sollReferenzzins:c,istReferenzzins:n.referenzzinssatz,sollMiete:i,istMiete:n.miete,differenzZins:u,differenzMiete:h,status:g,erklaerung:m}),d=n}f[0].satz,f[0].datum;let o=e.aktuell||d,{sollMiete:c,schritte:u}=j(o.miete,o.referenzzinssatz,o.datum,new Date().toISOString().split("T")[0]);if(u.length>0){let e=u[u.length-1];if(e.zins<o.referenzzinssatz){let i=o.miete-c;if(i>1){let d=e.datum,u=function(e){let t;let s=new Date(new Date(e));s.setMonth(s.getMonth()+3);let n=s.getMonth(),a=s.getFullYear();return(t=n<3?new Date(a,2,31):n<6?new Date(a,5,30):n<9?new Date(a,8,30):new Date(a,11,31))<=s&&(t.setMonth(t.getMonth()+3),5===t.getMonth()?t.setDate(30):8===t.getMonth()&&t.setDate(30)),t}(new Date);return n.push("❌ KRITISCH: Zinssenkung nicht ber\xfccksichtigt!","\uD83D\uDCB0 J\xe4hrliche Ersparnis: CHF ".concat((12*i).toFixed(2)),"Neue Miete: CHF ".concat(c.toFixed(2)," statt CHF ").concat(o.miete.toFixed(2))),a.push({datum:d,sollReferenzzins:e.zins,istReferenzzins:o.referenzzinssatz,sollMiete:c,istMiete:o.miete,differenzZins:e.zins-o.referenzzinssatz,differenzMiete:i,status:"fehlend",erklaerung:"Zinssenkung wurde NICHT ber\xfccksichtigt - Anspruch auf Mietreduzierung!"}),{isValid:!1,errors:t,warnings:s,kritisch:n,sollIstVergleiche:a,uebersprungeneSchritte:r,falscheberechnungen:l,einsparungsPotential:{monatlich:i,jaehrlich:12*i,naechsterTermin:u.toISOString().split("T")[0]}}}}}return{isValid:0===t.length&&0===n.length,errors:t,warnings:s,kritisch:n,sollIstVergleiche:a,uebersprungeneSchritte:r,falscheberechnungen:l}}({vertragsbeginn:H,anpassungen:l,aktuell:B});return r&&r(V),(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between flex-wrap gap-2",children:[(0,n.jsx)("h3",{className:"text-xl font-bold text-gray-900",children:"\uD83D\uDCCA Mietanpassungs-Historie"}),(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsx)("button",{onClick:()=>h(!u),className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors text-sm",children:u?"✕ Abbrechen":"\uD83D\uDCC4 Dokument hochladen"}),(0,n.jsx)("button",{onClick:()=>c(!o),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors text-sm",children:o?"✕ Abbrechen":"✏️ Manuell erfassen"})]})]}),(0,n.jsx)("p",{className:"text-gray-600 text-sm",children:"Laden Sie Mieterh\xf6hungs-/Reduktionsbriefe hoch oder erfassen Sie Anpassungen manuell. Das System validiert automatisch die Berechnungen und zeigt Ihr Einsparungspotential."}),u&&(0,n.jsxs)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-6 space-y-4",children:[(0,n.jsx)("h4",{className:"font-bold text-gray-900",children:"\uD83D\uDCC4 Anpassungs-Dokument hochladen"}),x?(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{className:"bg-white border border-gray-300 rounded-lg p-4 space-y-3",children:[(0,n.jsx)("h5",{className:"font-bold text-gray-900",children:"\uD83D\uDCCB Analysierte Daten:"}),(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-gray-600",children:"Datum"}),(0,n.jsx)("input",{type:"date",value:x.datum,onChange:e=>p({...x,datum:e.target.value}),className:"w-full px-2 py-1 border rounded"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-gray-600",children:"Typ"}),(0,n.jsx)("p",{className:"font-medium",children:"erh\xf6hung"===x.typ?"↑ Erh\xf6hung":"↓ Reduzierung"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-gray-600",children:"Alt: Referenzzins"}),(0,n.jsx)("input",{type:"number",step:"0.25",value:x.alterReferenzzinssatz,onChange:e=>p({...x,alterReferenzzinssatz:parseFloat(e.target.value)}),className:"w-full px-2 py-1 border rounded"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-gray-600",children:"Neu: Referenzzins"}),(0,n.jsx)("input",{type:"number",step:"0.25",value:x.neuerReferenzzinssatz,onChange:e=>p({...x,neuerReferenzzinssatz:parseFloat(e.target.value)}),className:"w-full px-2 py-1 border rounded"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-gray-600",children:"Alt: Miete (CHF)"}),(0,n.jsxs)("p",{className:"font-medium",children:["CHF ",x.alteMiete.toFixed(2)]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-gray-600",children:"Neu: Miete (CHF)"}),(0,n.jsx)("input",{type:"number",step:"0.01",value:x.neueMiete,onChange:e=>p({...x,neueMiete:parseFloat(e.target.value)}),className:"w-full px-2 py-1 border rounded"})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-gray-600 text-sm",children:"Begr\xfcndung"}),(0,n.jsx)("textarea",{value:x.begruendung,onChange:e=>p({...x,begruendung:e.target.value}),className:"w-full px-2 py-1 border rounded text-sm",rows:2})]}),x.zusaetzlicheGruende&&x.zusaetzlicheGruende.length>0&&(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-gray-600 text-sm",children:"Zus\xe4tzliche Gr\xfcnde"}),(0,n.jsx)("p",{className:"text-sm",children:x.zusaetzlicheGruende.join(", ")})]})]}),(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsx)("button",{onClick:()=>{x&&(G({datum:x.datum,referenzzinssatz:x.neuerReferenzzinssatz,miete:x.neueMiete,typ:x.typ,begründung:x.begruendung,dokumentUrl:b,zusaetzlicheGruende:x.zusaetzlicheGruende}),p(null),D(""),h(!1))},className:"flex-1 bg-green-600 text-white py-2 rounded-lg hover:bg-green-700",children:"✓ \xdcbernehmen"}),(0,n.jsx)("button",{onClick:()=>{p(null),D("")},className:"flex-1 bg-gray-300 text-gray-700 py-2 rounded-lg hover:bg-gray-400",children:"✕ Ablehnen"})]})]}):(0,n.jsx)("div",{children:(0,n.jsxs)("div",{className:"\n                  border-2 border-dashed rounded-lg p-6 text-center transition-all duration-200\n                  ".concat(g?"border-green-300 bg-green-100":N?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-blue-500","\n                "),onDragOver:e=>{e.preventDefault(),e.stopPropagation(),z(!0)},onDragLeave:e=>{e.preventDefault(),e.stopPropagation(),z(!1)},onDrop:e=>{e.preventDefault(),e.stopPropagation(),z(!1);let t=e.dataTransfer.files;if(t.length>0){let e=document.getElementById("anpassung-file-upload");if(e){let s=new DataTransfer;s.items.add(t[0]),e.files=s.files;let n=new Event("change",{bubbles:!0});e.dispatchEvent(n)}}},children:[(0,n.jsx)("input",{type:"file",accept:".pdf,.jpg,.jpeg,.png",onChange:I,disabled:g,className:"hidden",id:"anpassung-file-upload"}),(0,n.jsxs)("label",{htmlFor:"anpassung-file-upload",className:"cursor-pointer block ".concat(g?"cursor-not-allowed":""),children:[(0,n.jsx)("div",{className:"text-5xl mb-3",children:g?"\uD83E\uDD16":"\uD83D\uDCC4"}),(0,n.jsx)("div",{className:"text-base font-medium text-gray-700 mb-1",children:g?"KI analysiert das Dokument...":"Anpassungsdokument hochladen"}),(0,n.jsx)("div",{className:"text-sm text-gray-500",children:g?(0,n.jsx)("span",{className:"text-green-600",children:"⏳ Wird analysiert..."}):(0,n.jsxs)(n.Fragment,{children:["Klicken oder Datei hierher ziehen",(0,n.jsx)("br",{}),(0,n.jsx)("span",{className:"text-xs",children:"PDF, JPG oder PNG (max. 10 MB)"})]})})]})]})})]}),o&&(0,n.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6 space-y-4",children:[(0,n.jsx)("h4",{className:"font-bold text-gray-900",children:"✏️ Manuelle Erfassung"}),(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Datum *"}),(0,n.jsx)("input",{type:"date",value:v,onChange:e=>w(e.target.value),min:B.datum,className:"w-full px-4 py-2 border border-gray-300 rounded-lg"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Neuer Referenzzinssatz (%) *"}),(0,n.jsx)("input",{type:"number",step:"0.25",value:C,onChange:e=>P(e.target.value),placeholder:"z.B. 1.50",className:"w-full px-4 py-2 border border-gray-300 rounded-lg"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Neue Miete (CHF) *"}),(0,n.jsx)("input",{type:"number",step:"0.01",value:k,onChange:e=>F(e.target.value),placeholder:"Auto-berechnet",className:"w-full px-4 py-2 border border-gray-300 rounded-lg"}),(0,n.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Wird automatisch berechnet"})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Begr\xfcndung (optional)"}),(0,n.jsx)("textarea",{value:R,onChange:e=>M(e.target.value),placeholder:"z.B. Erh\xf6hung gem\xe4\xdf Brief vom...",className:"w-full px-4 py-2 border border-gray-300 rounded-lg",rows:2})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Zus\xe4tzliche Gr\xfcnde (optional)"}),(0,n.jsx)("div",{className:"flex gap-2 flex-wrap",children:["Teuerung","Kostensteigerung","Wertvermehrung"].map(e=>(0,n.jsx)("button",{type:"button",onClick:()=>{A.includes(e)?E(A.filter(t=>t!==e)):E([...A,e])},className:"px-3 py-1 rounded text-sm ".concat(A.includes(e)?"bg-blue-600 text-white":"bg-gray-200 text-gray-700"),children:e},e))})]}),(0,n.jsx)("button",{onClick:()=>{if(!v||!C||!k){alert("Bitte alle Pflichtfelder ausf\xfcllen");return}let e=parseFloat(k)>B.miete?"erh\xf6hung":"reduzierung";G({datum:v,referenzzinssatz:parseFloat(C),miete:parseFloat(k),typ:e,begründung:R||void 0,zusaetzlicheGruende:A.length>0?A:void 0}),w(""),S(""),F(""),M(""),E([]),c(!1)},className:"w-full bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-700",children:"✓ Hinzuf\xfcgen"})]}),(0,n.jsx)("div",{className:"bg-white border border-gray-200 rounded-lg overflow-hidden",children:(0,n.jsx)("div",{className:"overflow-x-auto",children:(0,n.jsxs)("table",{className:"w-full",children:[(0,n.jsx)("thead",{className:"bg-gray-50",children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Datum"}),(0,n.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Referenzzins"}),(0,n.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Miete"}),(0,n.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"\xc4nderung"}),(0,n.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Begr\xfcndung"}),(0,n.jsx)("th",{className:"px-4 py-3"})]})}),(0,n.jsxs)("tbody",{className:"divide-y divide-gray-200",children:[(0,n.jsxs)("tr",{className:"bg-blue-50",children:[(0,n.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:new Date(H.datum).toLocaleDateString("de-CH")}),(0,n.jsxs)("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:[H.referenzzinssatz,"%"]}),(0,n.jsxs)("td",{className:"px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900",children:["CHF ",H.miete.toFixed(2)]}),(0,n.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm font-medium text-blue-700",children:T(-1,H.miete,null).label}),(0,n.jsx)("td",{className:"px-4 py-3 text-sm text-gray-500",children:"-"}),(0,n.jsx)("td",{})]}),l.map((e,t)=>{let s=0===t?H:l[t-1],a=T(t,e.miete,s.miete);return(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:new Date(e.datum).toLocaleDateString("de-CH")}),(0,n.jsxs)("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:[e.referenzzinssatz,"%"]}),(0,n.jsxs)("td",{className:"px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900",children:["CHF ",e.miete.toFixed(2),e.dokumentUrl&&(0,n.jsx)("a",{href:e.dokumentUrl,target:"_blank",rel:"noopener noreferrer",className:"ml-2 text-blue-600 hover:underline text-xs",children:"\uD83D\uDCC4"})]}),(0,n.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm font-medium ".concat(a.color),children:a.label}),(0,n.jsxs)("td",{className:"px-4 py-3 text-sm text-gray-600 max-w-xs truncate",children:[e.begründung||"-",e.zusaetzlicheGruende&&e.zusaetzlicheGruende.length>0&&(0,n.jsxs)("span",{className:"text-orange-600 ml-1",children:["+",e.zusaetzlicheGruende.length]})]}),(0,n.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-right text-sm",children:(0,n.jsx)("button",{onClick:()=>U(t),className:"text-red-600 hover:text-red-700",children:"✕"})})]},t)})]})]})})}),V.sollIstVergleiche.length>0&&(0,n.jsxs)("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[(0,n.jsx)("h4",{className:"font-bold text-gray-900 mb-3",children:"\uD83D\uDD0D Soll-Ist Vergleich"}),(0,n.jsx)("div",{className:"space-y-1 text-sm font-mono",children:V.sollIstVergleiche.map((e,t)=>(0,n.jsx)("div",{children:function(e){let t=new Date(e.datum).toLocaleDateString("de-CH"),s={korrekt:"✅",zu_hoch:"⚠️",zu_niedrig:"ℹ️",fehlend:"❌"}[e.status];return"".concat(s," ").concat(t,": Soll ").concat(e.sollMiete.toFixed(2)," @ ").concat(e.sollReferenzzins,"% | ")+"Ist ".concat(e.istMiete.toFixed(2)," @ ").concat(e.istReferenzzins,"% | ")+"".concat(e.erklaerung)}(e)},t))})]}),V.uebersprungeneSchritte.length>0&&(0,n.jsxs)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[(0,n.jsx)("h4",{className:"font-bold text-yellow-900 mb-2",children:"⚠️ \xdcbersprungene Zins\xe4nderungen"}),V.uebersprungeneSchritte.map((e,t)=>(0,n.jsx)("p",{className:"text-sm text-yellow-800",children:e},t))]}),V.falscheberechnungen.length>0&&(0,n.jsxs)("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4",children:[(0,n.jsx)("h4",{className:"font-bold text-orange-900 mb-2",children:"⚠️ M\xf6gliche Berechnungsfehler"}),V.falscheberechnungen.map((e,t)=>(0,n.jsx)("p",{className:"text-sm text-orange-800 mb-2",children:e},t))]}),V.warnings.length>0&&(0,n.jsxs)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[(0,n.jsx)("h4",{className:"font-bold text-yellow-900 mb-2",children:"⚠️ Hinweise"}),V.warnings.map((e,t)=>(0,n.jsx)("p",{className:"text-sm text-yellow-800 mb-2",children:e},t))]}),V.kritisch.length>0&&(0,n.jsx)("div",{className:"bg-red-50 border-2 border-red-500 rounded-lg p-6",children:(0,n.jsx)("div",{className:"space-y-2",children:V.kritisch.map((e,t)=>0===t?(0,n.jsx)("p",{className:"text-2xl font-bold text-red-900",children:e},t):1===t&&e.includes("J\xe4hrliche Ersparnis")?(0,n.jsx)("p",{className:"text-3xl font-extrabold text-red-900",children:e},t):(0,n.jsx)("p",{className:"text-sm text-red-800",children:e},t))})}),V.errors.length>0&&(0,n.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[(0,n.jsx)("h4",{className:"font-bold text-red-900 mb-2",children:"❌ Fehler"}),V.errors.map((e,t)=>(0,n.jsx)("p",{className:"text-sm text-red-800",children:e},t))]}),(0,n.jsxs)("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-6",children:[(0,n.jsx)("h4",{className:"font-bold text-gray-900 mb-4",children:"\uD83D\uDCCD Aktueller Status"}),(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-sm text-gray-600",children:"Aktuelle Miete"}),(0,n.jsxs)("p",{className:"text-2xl font-bold text-gray-900",children:["CHF ",B.miete.toFixed(2)]}),(0,n.jsxs)("p",{className:"text-xs text-gray-500",children:["Basierend auf ",B.referenzzinssatz,"%"]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-sm text-gray-600",children:"Aktueller Referenzzins"}),(0,n.jsxs)("p",{className:"text-2xl font-bold text-gray-900",children:[f[0].satz,"%"]}),(0,n.jsxs)("p",{className:"text-xs text-gray-500",children:["Stand: ",new Date(f[0].datum).toLocaleDateString("de-CH")]})]})]})]})]})}function N(){let e=(0,r.useRouter)(),[t,s]=(0,a.useState)({address:"",netRent:"",currentRate:"1.25",contractDate:""}),[i,d]=(0,a.useState)(null),[o,c]=(0,a.useState)(null),[u,h]=(0,a.useState)(null),[g,m]=(0,a.useState)(!1),[x,p]=(0,a.useState)(null),[f,y]=(0,a.useState)(!1),[j,N]=(0,a.useState)(null),z=e=>{s({...t,[e.target.name]:e.target.value})},v=()=>{let s={contract:{address:t.address,landlordName:(null==i?void 0:i.landlordName)||"",landlordAddress:(null==i?void 0:i.landlordAddress)||"",contractDate:t.contractDate,netRent:parseFloat(t.netRent),referenceRate:parseFloat(t.currentRate)},calculation:{currentRent:x.currentRent,newRent:x.newRent,monthlyReduction:x.monthlyReduction,yearlySavings:x.yearlySavings},historie:o,hasHistory:x.hasHistory||!1,einsparungDetails:x.einsparungDetails||null,validation:x.validation||null};if(window.sessionStorage){sessionStorage.setItem("mietCheckData",JSON.stringify(s)),console.log("\uD83D\uDCBE Saved complete data to sessionStorage:",s);let t=sessionStorage.getItem("currentContractId");t?e.push("/generate?contractId=".concat(t)):e.push("/generate")}else e.push("/generate")},w=async e=>{e.preventDefault(),y(!0),N(null),p(null);try{let e=await fetch("/api/analyze",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({address:t.address,currentRent:parseFloat(t.netRent),currentReferenceRate:parseFloat(t.currentRate),newReferenceRate:1.25,contractDate:t.contractDate,mietHistorie:o})}),s=await e.json();if(!e.ok)throw Error(s.error||"Berechnung fehlgeschlagen");p(s);try{let e=await fetch("/api/user/contracts",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({address:t.address,netRent:parseFloat(t.netRent),referenceRate:parseFloat(t.currentRate),contractDate:t.contractDate,landlordName:(null==i?void 0:i.landlordName)||"",landlordAddress:(null==i?void 0:i.landlordAddress)||"",newRent:s.newRent,monthlyReduction:s.monthlyReduction,yearlySavings:s.yearlySavings})});if(e.ok){let t=await e.json();console.log("✅ Contract saved to DB:",t.contractId),window.sessionStorage&&sessionStorage.setItem("currentContractId",t.contractId.toString())}}catch(e){console.log("ℹ️ Could not save to DB (user might not be logged in):",e)}}catch(e){N(e instanceof Error?e.message:"Ein Fehler ist aufgetreten")}finally{y(!1)}};return(0,n.jsx)("div",{className:"min-h-screen bg-gradient-to-b from-blue-50 to-white py-12 px-4",children:(0,n.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,n.jsxs)("div",{className:"text-center mb-8",children:[(0,n.jsx)(l.default,{href:"/",className:"text-blue-600 hover:text-blue-700 mb-4 inline-block",children:"← Zur\xfcck zur Startseite"}),(0,n.jsx)("h1",{className:"text-4xl font-bold text-gray-900 mb-4",children:"Service 1: Mietvertrag-Analyse"}),(0,n.jsx)("p",{className:"text-xl text-gray-600",children:"Laden Sie Ihren Mietvertrag hoch f\xfcr eine automatische Analyse"}),(0,n.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mt-4 inline-block",children:(0,n.jsxs)("p",{className:"text-sm text-blue-800",children:["\uD83D\uDCB0 ",(0,n.jsx)("strong",{children:"Kosten:"})," CHF 20 (einmalig)"]})})]}),(0,n.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-8 mb-8",children:[(0,n.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"\uD83E\uDD16 Automatische Analyse mit KI"}),(0,n.jsx)("p",{className:"text-gray-600 mb-6",children:"Laden Sie Ihren Mietvertrag hoch (PDF, JPG oder PNG). Unsere KI extrahiert automatisch:"}),(0,n.jsxs)("ul",{className:"list-disc list-inside text-gray-600 mb-6 space-y-2",children:[(0,n.jsx)("li",{children:"Adresse der Mietwohnung"}),(0,n.jsx)("li",{children:"Nettomiete (Grundmiete ohne Nebenkosten)"}),(0,n.jsx)("li",{children:"Referenzzinssatz bei Vertragsabschluss"}),(0,n.jsx)("li",{children:"Vertragsdatum"}),(0,n.jsx)("li",{children:"Vermieterinformationen"})]}),(0,n.jsx)(b,{onAnalysisComplete:e=>{console.log("\uD83D\uDCCA Auto-filling form with analyzed data:",e),d(e),s({address:e.address,netRent:e.netRent.toString(),currentRate:e.referenceRate.toString(),contractDate:e.contractDate}),m(!0),N(null)}})]}),(0,n.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-8 mb-8",children:[(0,n.jsxs)("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:["✏️ Vertragsdaten ",t.address&&"(automatisch ausgef\xfcllt)"]}),(0,n.jsx)("p",{className:"text-gray-600 mb-6",children:t.address?"Bitte \xfcberpr\xfcfen Sie die automatisch ausgef\xfcllten Daten und korrigieren Sie sie bei Bedarf.":"Oder geben Sie die Daten manuell ein, falls Sie keinen Vertrag hochladen m\xf6chten."}),(0,n.jsxs)("form",{onSubmit:w,className:"space-y-6",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"\uD83D\uDCCD Adresse der Mietwohnung"}),(0,n.jsx)("input",{type:"text",name:"address",value:t.address,onChange:z,placeholder:"z.B. Musterstrasse 123, 8000 Z\xfcrich",required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"\uD83D\uDCB0 Nettomiete (CHF/Monat)"}),(0,n.jsx)("input",{type:"number",name:"netRent",value:t.netRent,onChange:z,placeholder:"z.B. 2000",step:"0.01",min:"0",required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),(0,n.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Grundmiete ohne Nebenkosten"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"\uD83D\uDCCA Referenzzinssatz bei Vertragsabschluss (%)"}),(0,n.jsxs)("select",{name:"currentRate",value:t.currentRate,onChange:z,required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,n.jsx)("option",{value:"1.25",children:"1.25% (seit Sept 2025)"}),(0,n.jsx)("option",{value:"1.50",children:"1.50% (M\xe4rz - Aug 2025)"}),(0,n.jsx)("option",{value:"1.75",children:"1.75% (Dez 2023 - Feb 2025)"}),(0,n.jsx)("option",{value:"2.00",children:"2.00% oder h\xf6her"})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"\uD83D\uDCC5 Vertragsdatum"}),(0,n.jsx)("input",{type:"date",name:"contractDate",value:t.contractDate,onChange:z,required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,n.jsx)("button",{type:"submit",disabled:f,className:"w-full bg-blue-600 text-white py-4 rounded-lg font-bold text-lg hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors",children:f?"⏳ Berechnung l\xe4uft...":"\uD83E\uDDEE Einsparung berechnen"})]}),j&&(0,n.jsx)("div",{className:"mt-6 bg-red-50 border border-red-200 rounded-lg p-4",children:(0,n.jsxs)("p",{className:"text-red-800 font-medium",children:["❌ ",j]})}),x&&(()=>{let e=g&&(null==u?void 0:u.einsparungsPotential)?{currentRent:x.currentRent,newRent:x.currentRent-u.einsparungsPotential.monatlich,monthlyReduction:u.einsparungsPotential.monatlich,yearlySavings:u.einsparungsPotential.jaehrlich}:x;return(0,n.jsxs)("div",{className:"mt-8 bg-green-50 border-2 border-green-500 rounded-lg p-6",children:[(0,n.jsx)("h3",{className:"text-2xl font-bold text-green-900 mb-4",children:"\uD83C\uDF89 Ihr Einsparungspotential"}),(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,n.jsxs)("div",{className:"bg-white rounded-lg p-4",children:[(0,n.jsx)("p",{className:"text-sm text-gray-600",children:"Aktuelle Miete"}),(0,n.jsxs)("p",{className:"text-2xl font-bold text-gray-900",children:["CHF ",e.currentRent.toFixed(2)]})]}),(0,n.jsxs)("div",{className:"bg-white rounded-lg p-4",children:[(0,n.jsx)("p",{className:"text-sm text-gray-600",children:"Neue Miete"}),(0,n.jsxs)("p",{className:"text-2xl font-bold text-green-600",children:["CHF ",e.newRent.toFixed(2)]})]}),(0,n.jsxs)("div",{className:"bg-white rounded-lg p-4",children:[(0,n.jsx)("p",{className:"text-sm text-gray-600",children:"Monatliche Reduktion"}),(0,n.jsxs)("p",{className:"text-2xl font-bold text-blue-600",children:["CHF ",e.monthlyReduction.toFixed(2)]})]}),(0,n.jsxs)("div",{className:"bg-white rounded-lg p-4",children:[(0,n.jsx)("p",{className:"text-sm text-gray-600",children:"J\xe4hrliche Einsparung"}),(0,n.jsxs)("p",{className:"text-2xl font-bold text-blue-600",children:["CHF ",e.yearlySavings.toFixed(2)]})]})]}),(0,n.jsx)("div",{className:"mt-6 text-center",children:e.yearlySavings>0?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("button",{onClick:v,className:"inline-block bg-green-600 text-white px-8 py-3 rounded-lg font-bold hover:bg-green-700 transition-colors",children:"\uD83D\uDCC4 Weiter zu Service 2: Brief generieren"}),(0,n.jsx)("p",{className:"text-sm text-gray-600 mt-2",children:"\uD83D\uDCA1 Alle Daten werden automatisch \xfcbernommen"})]}):(0,n.jsx)("div",{className:"bg-gray-100 border border-gray-300 rounded-lg p-4",children:(0,n.jsx)("p",{className:"text-gray-700",children:"ℹ️ Aktuell keine Herabsetzung m\xf6glich. Der Referenzzins ist seit Ihrem Vertrag nicht gesunken."})})})]})})()]}),g&&t.contractDate&&t.netRent&&t.currentRate&&(0,n.jsx)("div",{className:"bg-white rounded-lg shadow-lg p-8 mb-8",children:(0,n.jsx)(D,{vertragsbeginn:{datum:t.contractDate,miete:parseFloat(t.netRent),referenzzinssatz:parseFloat(t.currentRate)},onHistorieChange:e=>{c(e)}})}),(0,n.jsxs)("div",{className:"mt-8 bg-gray-50 border border-gray-200 rounded-lg p-6",children:[(0,n.jsx)("h3",{className:"text-lg font-bold text-gray-900 mb-3",children:"ℹ️ Wichtige Hinweise"}),(0,n.jsxs)("ul",{className:"text-sm text-gray-600 space-y-2",children:[(0,n.jsx)("li",{children:"• Die Berechnung basiert auf Art. 13 VMWG (Mietrecht)"}),(0,n.jsx)("li",{children:"• Der aktuelle Referenzzinssatz betr\xe4gt 1.25% (seit Sept 2025)"}),(0,n.jsx)("li",{children:"• Nur Mietvertr\xe4ge mit Referenzzinssatz-Klausel sind berechtigt"}),(0,n.jsx)("li",{children:"• Die KI-Analyse ist ein Hilfsmittel - bitte pr\xfcfen Sie die Daten"}),(0,n.jsxs)("li",{children:["• ",(0,n.jsx)("strong",{children:"NEU:"})," Erfassen Sie alle bisherigen Mietanpassungen f\xfcr eine pr\xe4zisere Berechnung"]}),(0,n.jsxs)("li",{children:["• ",(0,n.jsx)("strong",{children:"NEU:"})," Alle Daten werden automatisch an Service 2 \xfcbergeben - Sie m\xfcssen nichts zweimal eingeben!"]})]})]})]})})}}},function(e){e.O(0,[972,64,596,971,117,744],function(){return e(e.s=7591)}),_N_E=e.O()}]);